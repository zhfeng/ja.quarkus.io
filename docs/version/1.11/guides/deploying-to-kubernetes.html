<!DOCTYPE html>
<html>





<head>
  <title>Quarkus - Kubernetes extension - 1.11</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="default-src https://dpm.demdex.net; script-src 'self' 'unsafe-eval' 'sha256-ANpuoVzuSex6VhqpYgsG25OHWVA1I+F6aGU04LoI+5s=' 'sha256-ipy9P/3rZZW06mTLAR0EnXvxSNcnfSDPLDuh3kzbB1w=' js.bizographics.com https://www.redhat.com https://static.redhat.com assets.adobedtm.com jsonip.com https://ajax.googleapis.com https://www.googletagmanager.com https://www.google-analytics.com https://use.fontawesome.com https://app.mailjet.com http://www.youtube.com http://www.googleadservices.com https://googleads.g.doubleclick.net https://dpm.demdex.net https://giscus.app; style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; img-src 'self' *; media-src 'self'; frame-src https://www.googletagmanager.com https://www.youtube.com https://embed.restream.io https://app.mailjet.com https://giscus.app; base-uri 'none'; object-src 'none'; form-action 'none'; font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/version/1.11/guides/deploying-to-kubernetes" />
  <meta property="og:title" content="Quarkus - Kubernetes extension - 1.11" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/deploying-to-kubernetes">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/goan.js" type="text/javascript"></script>
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
</head>

<body class="guides">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJWS5L"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
  <div class="container">
    <div class="logo-wrapper">
        <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
    </div>
    <label class="nav-toggle" for="checkbox"> <i class="fa fa-bars"></i>
</label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="/about/">Quarkusとは <i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">QUARKUSとは何か?</a></li>
          <li><a href="/container-first" class="">コンテナ・ファースト</a></li>
          <li><a href="/continuum" class="">リアクティブ</a></li>
          <li><a href="/developer-joy" class="">開発者満足</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">標準</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/learn/">学ぶ<i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">入門</a></li>
          <li><a href="/guides" class="active">ガイド</a></li>
          <li><a href="/qtips" class="">"Q" Tipsビデオ</a></li>          
          <li><a href="/books" class="">書籍</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="/community/">コミュニティ <i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">サポート</a></li>
          <li><a href="/blog" class="">ブログ</a></li>
          <li><a href="/discussion" class="">ディスカッション</a></li>
          <li><a href="/insights" class="">ポッドキャスト</a></li>
          <li><a href="/events" class="">イベント</a></li>
          <li><a href="/newsletter" class="">ニュースレター</a></li>
          <li><a href="/publications" class="">出版物</a></li>
          <li><a href="/awards" class="">受賞</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary
white">コーディングを開始</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/" >ENGLISH</a></li>
          <li><a href="https://ja.quarkus.io/">JAPANESE</a></li>
          </ul>
      </li>
    </ul>
  </div>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    



<div class="full-width-version-bg grey align-self">
  <div class="grid-wrapper">
    <div class="grid__item width-6-12">
      <p class="returnlink"><i class="fas fa-angle-left"></i><a href="/version/1.11/guides/"> Back to Guides</a></p>
    </div>
    <div class="grid__item width-6-12 align-self-center text-right hide-mobile">
      <label id="guide-version-label">Select Guide Version</label>
      <select id="guide-version-dropdown">
        
      
        
        
        
        
          
        <option value="main" >Main - SNAPSHOT</option>
        
        
      
        
        
        
        
          
        <option value="latest" >2.9 - Latest</option>
        
        
      
        
        
        
        
          
        <option value="2.7" >2.7</option>
        
        
      
        
        
        
        
          
        <option value="2.2" >2.2</option>
        
        
      
        
        
        
        
          
        <option value="1.11" selected>1.11</option>
        
        
      
    
      </select>
    </div>
  </div>
</div>

<div class="grid-wrapper guide">
  <div class="grid__item width-12-12 width-12-12-mobile">
    <h1 class="text-caps">Quarkus - Kubernetes extension </h1>
  </div>
  <div class="width-12-12">
    <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#前提条件">前提条件</a></li>
<li><a href="#kubernetes">Kubernetes</a>
<ul class="sectlevel2">
<li><a href="#名前空間">名前空間</a></li>
<li><a href="#defining-a-docker-registry">Defining a Docker registry</a></li>
<li><a href="#ラベルとアノテーション">ラベルとアノテーション</a></li>
<li><a href="#レプリカ数を変更する">レプリカ数を変更する</a></li>
<li><a href="#rediness-および-liveness-プローブを追加する">rediness および liveness プローブを追加する</a></li>
<li><a href="#rediness-プローブのカスタマイズ">rediness プローブのカスタマイズ</a></li>
<li><a href="#hostaliases-の追加">hostAliases の追加</a></li>
<li><a href="#コンテナリソース管理">コンテナリソース管理</a></li>
<li><a href="#using-the-kubernetes-client">Using the Kubernetes client</a></li>
<li><a href="#deploying-to-minikube">Deploying to Minikube</a></li>
</ul>
</li>
<li><a href="#application-properties-を使用して生成されたリソースをチューニングする">application.properties を使用して生成されたリソースをチューニングする</a>
<ul class="sectlevel2">
<li><a href="#設定オプション">設定オプション</a></li>
<li><a href="#openshift">OpenShift</a></li>
<li><a href="#knative">Knative</a></li>
<li><a href="#デプロイメントターゲット">デプロイメントターゲット</a></li>
<li><a href="#非推奨の設定">非推奨の設定</a></li>
</ul>
</li>
<li><a href="#デプロイメント">デプロイメント</a>
<ul class="sectlevel2">
<li><a href="#コンテナーイメージのビルド">コンテナーイメージのビルド</a></li>
<li><a href="#デプロイ">デプロイ</a></li>
</ul>
</li>
<li><a href="#既存のリソースの利用">既存のリソースの利用</a></li>
</ul></div>
    <div>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Quarkusは、 <a href="https://github.com/dekorateio/dekorate/">dekorate</a> を使用して、妥当なデフォルトとユーザーが提供する設定に基づいてKubernetesリソースを自動的に生成する機能を提供しています。現在、バニラ <a href="#kubernetes">Kubernetes</a> 、 <a href="#openshift">OpenShift</a> 、 <a href="#knative">Knative</a> のリソース生成をサポートしています。さらに、Quarkusは、生成されたマニフェストをターゲットクラスターのAPI Serverに適用することで、ターゲットKubernetesクラスターにアプリケーションをデプロイすることができます。最後に、コンテナーイメージエクステンションのいずれかが存在する場合(詳細は <a href="container-image">コンテナーイメージガイド</a> を参照)、Quarkusでは、ターゲットプラットフォームにアプリケーションをデプロイする <strong>前</strong> に、 コンテナーイメージを作成してレジストリーにプッシュする機能があります。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="前提条件"><a class="anchor" href="#前提条件"></a>前提条件</h2>
<div class="sectionbody">
<div class="paragraph">
<p>このガイドを完成させるには、以下が必要です:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>roughly 10 minutes</p>
</li>
<li>
<p>IDE</p>
</li>
<li>
<p>JDK 1.8+ がインストールされ、 <code>JAVA_HOME</code> が適切に設定されていること</p>
</li>
<li>
<p>Apache Maven 3.6.2+</p>
</li>
<li>
<p>Kubernetes クラスターへのアクセス (Minikube も選択可能なオプションです)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="kubernetes"><a class="anchor" href="#kubernetes"></a>Kubernetes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Kubernetes エクステンションとJib エクステンションの両方を含む新しいプロジェクトを作成してみましょう。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn io.quarkus:quarkus-maven-plugin:1.11.7.Final:create \
    -DprojectGroupId=org.acme \
    -DprojectArtifactId=kubernetes-quickstart \
    -DclassName="org.acme.rest.GreetingResource" \
    -Dpath="/greeting" \
    -Dextensions="resteasy,kubernetes,jib"
cd kubernetes-quickstart</code></pre>
</div>
</div>
<div class="paragraph">
<p>これにより、以下の依存関係が `pom.xml`に追加されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">    &lt;dependency&gt;
      &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
      &lt;artifactId&gt;quarkus-kubernetes&lt;/artifactId&gt;
    &lt;/dependency&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
      &lt;artifactId&gt;quarkus-container-image-jib&lt;/artifactId&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>これらの依存関係を追加することで、ビルドを実行するたびに Kubernetes のマニフェストを生成できるようになり、同時に Jib を使用したコンテナーイメージのビルドも可能になります。例えば、 <code>./mvnw package</code> を実行すると、作成される他のファイルの中に <code>kubernetes.json</code> と <code>kubernetes.yml</code> という名前のファイルが <code>target/kubernetes/</code> ディレクトリーにあることに気づくでしょう。</p>
</div>
<div class="paragraph">
<p>どちらのファイルを見ても、Kubernetes <code>Deployment</code> と <code>Service</code> 両方が含まれていることに気づくでしょう。</p>
</div>
<div class="paragraph">
<p><code>kubernetes.json</code> ファイルの完全なソースはこんな感じです:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  {
    "apiVersion" : "apps/v1",
    "kind" : "Deployment",
    "metadata" : {
      "annotations": {
       "app.quarkus.io/vcs-url" : "&lt;some url&gt;",
       "app.quarkus.io/commit-id" : "&lt;some git SHA&gt;",
      },
      "labels" : {
        "app.kubernetes.io/name" : "test-quarkus-app",
        "app.kubernetes.io/version" : "1.0.0-SNAPSHOT",
      },
      "name" : "test-quarkus-app"
    },
    "spec" : {
      "replicas" : 1,
      "selector" : {
        "matchLabels" : {
          "app.kubernetes.io/name" : "test-quarkus-app",
          "app.kubernetes.io/version" : "1.0.0-SNAPSHOT",
        }
      },
      "template" : {
        "metadata" : {
          "labels" : {
            "app.kubernetes.io/name" : "test-quarkus-app",
            "app.kubernetes.io/version" : "1.0.0-SNAPSHOT"
          }
        },
        "spec" : {
          "containers" : [ {
            "env" : [ {
              "name" : "KUBERNETES_NAMESPACE",
              "valueFrom" : {
                "fieldRef" : {
                  "fieldPath" : "metadata.namespace"
                }
              }
            } ],
            "image" : "yourDockerUsername/test-quarkus-app:1.0.0-SNAPSHOT",
            "imagePullPolicy" : "Always",
            "name" : "test-quarkus-app"
          } ]
        }
      }
    }
  },
  {
  "apiVersion" : "v1",
  "kind" : "Service",
    "metadata" : {
      "annotations": {
       "app.quarkus.io/vcs-url" : "&lt;some url&gt;",
       "app.quarkus.io/commit-id" : "&lt;some git SHA&gt;",
      },
      "labels" : {
        "app.kubernetes.io/name" : "test-quarkus-app",
        "app.kubernetes.io/version" : "1.0.0-SNAPSHOT",
      },
      "name" : "test-quarkus-app"
    },
  "spec" : {
    "ports" : [ {
      "name" : "http",
      "port" : 8080,
      "targetPort" : 8080
    } ],
    "selector" : {
      "app.kubernetes.io/name" : "test-quarkus-app",
      "app.kubernetes.io/version" : "1.0.0-SNAPSHOT"
    },
    "type" : "ClusterIP"
  }
 }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>生成されたマニフェストは、 <code>kubectl</code> を使用してプロジェクトのルートからクラスターに適用することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -f target/kubernetes/kubernetes.json</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>Deployment</code> について注意すべき重要なことは、 <code>Pod</code> のコンテナーイメージとして <code>yourDockerUsername/test-quarkus-app:1.0-SNAPSHOT</code> を使用していることです。イメージの名前は Jib エクステンションによって制御され、通常の <code>application.properties</code> を利用してカスタマイズできます。</p>
</div>
<div class="paragraph">
<p>例えば、次のような設定の場合:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.container-image.group=quarkus #optional, default to the system user name
quarkus.container-image.name=demo-app #optional, defaults to the application name
quarkus.container-image.tag=1.0       #optional, defaults to the application version</code></pre>
</div>
</div>
<div class="paragraph">
<p>生成されたマニフェストで使用されるイメージは <code>quarkus/demo-app:1.0</code> となります</p>
</div>
<div class="sect2">
<h3 id="名前空間"><a class="anchor" href="#名前空間"></a>名前空間</h3>
<div class="paragraph">
<p>デフォルトでは、Quarkusは生成されたマニフェストの名前空間を省略し、 <code>default</code> 名前空間を強制しません。つまり、 <code>kubctl</code> (以下の例では <code>test</code> )を使用している場合は、選択したネームスペースにマニフェストを適用することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -f target/kubernetes/kubernetes.json -n=test</code></pre>
</div>
</div>
<div class="paragraph">
<p>マニフェストで名前空間を指定するには、 <code>application.properties</code> の中で次のプロパティによってカスタマイズします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.namespace=mynamespace</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="defining-a-docker-registry"><a class="anchor" href="#defining-a-docker-registry"></a>Defining a Docker registry</h3>
<div class="paragraph">
<p>The Docker registry can be specified with the following property:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.container-image.registry=my.docker-registry.net</code></pre>
</div>
</div>
<div class="paragraph">
<p>前のセクションで説明したコンテナーイメージプロパティーと一緒にこのプロパティーを追加すると、生成されるマニフェストではイメージ <code>my.docker-registry.net/quarkus/demo-app:1.0</code> を使用するようになります。次のセクションで明らかになるように、生成されるマニフェストでカスタマイズできるのはイメージだけではありません。</p>
</div>
</div>
<div class="sect2">
<h3 id="ラベルとアノテーション"><a class="anchor" href="#ラベルとアノテーション"></a>ラベルとアノテーション</h3>
<div class="sect3">
<h4 id="ラベル"><a class="anchor" href="#ラベル"></a>ラベル</h4>
<div class="paragraph">
<p>生成されたマニフェストには、Kubernetes <a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/common-labels">推奨のラベル</a>が使用されます。これらのラベルは、 <code>quarkus.kubernetes.name</code>, <code>quarkus.kubernetes.version</code> および <code>quarkus.kubernetes.part-of</code> を使用してカスタマイズすることができます。例えば、 <code>application.properties</code> に以下の設定を追加してください:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.part-of=todo-app
quarkus.kubernetes.name=todo-rest
quarkus.kubernetes.version=1.0-rc.1</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><a href="#openshift">OpenShift</a> のセクションで詳しく説明しているように、OpenShift (または Knative) のプロパティーのカスタマイズは同じ方法で行いますが、 <code>kubernetes</code> を <code>openshift</code> (または <code>knative</code> ) に置き換えます。OpenShiftに対する先ほどの例は次のようになります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.openshift.part-of=todo-app
quarkus.openshift.name=todo-rest
quarkus.openshift.version=1.0-rc.1</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>生成されたリソースのラベルは次のようになります:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">  "labels" : {
    "app.kubernetes.io/part-of" : "todo-app",
    "app.kubernetes.io/name" : "todo-rest",
    "app.kubernetes.io/version" : "1.0-rc.1"
  }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="custom-labels"><a class="anchor" href="#custom-labels"></a>Custom Labels</h4>
<div class="paragraph">
<p>追加のカスタムラベルを追加するには、例えば <code>foo=bar</code> を設定する場合、以下の設定を適用するだけです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.labels.foo=bar</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<code>quarkus-container-image-jib</code> エクステンションモジュールを使用してコンテナーイメージを作成する場合、前述のプロパティーを介して追加されたラベルも生成されたコンテナーイメージに追加されます。
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="アノテーション"><a class="anchor" href="#アノテーション"></a>アノテーション</h4>
<div class="paragraph">
<p>生成されたリソースにはバージョン管理に関連する情報がアノテーションされ、ツールによって、またはユーザーがトラブルシューティングの目的で使用することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">  "annotations": {
    "app.quarkus.io/vcs-url" : "&lt;some url&gt;",
    "app.quarkus.io/commit-id" : "&lt;some git SHA&gt;",
   }</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="カスタムアノテーション"><a class="anchor" href="#カスタムアノテーション"></a>カスタムアノテーション</h4>
<div class="paragraph">
<p>例えば、注釈 <code>foo=bar</code> と <code>app.quarkus/id=42</code> を追加するには、次の設定を適用するだけです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.annotations.foo=bar
quarkus.kubernetes.annotations."app.quarkus/id"=42</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="env-vars"><a class="anchor" href="#env-vars"></a>環境変数</h4>
<div class="paragraph">
<p>Kubernetesでは、環境変数を定義する方法が複数用意されています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>key/value pairs</p>
</li>
<li>
<p>Secret または ConfigMap からすべての値をインポートする</p>
</li>
<li>
<p>Secret または ConfigMap の指定されたフィールドで識別される単一の値を補間する</p>
</li>
<li>
<p>interpolate a value from a field within the same resource</p>
</li>
</ul>
</div>
<div class="sect4">
<h5 id="キー値のペアからの環境変数"><a class="anchor" href="#キー値のペアからの環境変数"></a>キー/値のペアからの環境変数</h5>
<div class="paragraph">
<p>生成されたリソースに環境変数としてキーとバリューのペアを追加する場合:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.env.vars.my-env-var=foobar</code></pre>
</div>
</div>
<div class="paragraph">
<p>上のコマンドは <code>MY_ENV_VAR=foobar</code> を環境変数として追加します。キー <code>my-env-var</code> は大文字に変換され、ダッシュはアンダースコアに置き換えられて <code>MY_ENV_VAR</code> となることに注意してください。</p>
</div>
</div>
<div class="sect4">
<h5 id="シークレットからの環境変数"><a class="anchor" href="#シークレットからの環境変数"></a>シークレットからの環境変数</h5>
<div class="paragraph">
<p><code>Secret</code> のすべてのキーと値のペアを環境変数として追加するには、以下の設定を適用し、ソースとして使用する各 <code>Secret</code> をカンマ ( <code>,</code> ) で区切ってください。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.env.secrets=my-secret,my-other-secret</code></pre>
</div>
</div>
<div class="paragraph">
<p>とすると、コンテナーの定義に以下のようなものが生成されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">envFrom:
  - secretRef:
      name: my-secret
      optional: false
  - secretRef:
      name: my-other-secret
      optional: false</code></pre>
</div>
</div>
<div class="paragraph">
<p>以下は、 <code>my-secret</code> Secret から <code>keyName</code> フィールドで識別される値を <code>foo</code> 環境変数に抽出します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.env.mapping.foo.from-secret=my-secret
quarkus.kubernetes.env.mapping.foo.with-key=keyName</code></pre>
</div>
</div>
<div class="paragraph">
<p>これにより、コンテナーの <code>env</code> セクションに以下のようなものが生成されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- env:
  - name: FOO
    valueFrom:
      secretKeyRef:
        key: keyName
        name: my-secret
        optional: false</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="environment-variables-from-configmap"><a class="anchor" href="#environment-variables-from-configmap"></a>Environment variables from ConfigMap</h5>
<div class="paragraph">
<p><code>ConfigMap</code> からのすべてのキーと値のペアを環境変数として追加するには、以下の設定を適用し、ソースとして使用する各 <code>ConfigMap</code> をカンマ ( <code>,</code> ) で区切ってください。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.env.configmaps=my-config-map,another-config-map</code></pre>
</div>
</div>
<div class="paragraph">
<p>とすると、コンテナーの定義に以下のようなものが生成されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">envFrom:
  - configMapRef:
      name: my-config-map
      optional: false
  - configMapRef:
      name: another-config-map
      optional: false</code></pre>
</div>
</div>
<div class="paragraph">
<p>以下は、 <code>my-config-map</code> ConfigMap から <code>keyName</code> フィールドで識別される値を <code>foo</code> 環境変数に抽出したものです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.env.mapping.foo.from-configmap=my-configmap
quarkus.kubernetes.env.mapping.foo.with-key=keyName</code></pre>
</div>
</div>
<div class="paragraph">
<p>これにより、コンテナーの <code>env</code> セクションに以下のようなものが生成されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">- env:
  - name: FOO
    valueFrom:
      configMapRefKey:
        key: keyName
        name: my-configmap
        optional: false</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="フィールドからの環境変数"><a class="anchor" href="#フィールドからの環境変数"></a>フィールドからの環境変数</h5>
<div class="paragraph">
<p>また、以下のように、ソースとして使用するフィールドのパスを指定することで、別のフィールドの値を使用して新しい環境変数を追加することも可能です。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.env.fields.foo=metadata.name</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><a href="#openshift">OpenShift</a> の項で詳しく説明していますが、OpenShift のプロパティーのカスタマイズも同じ方法で行いますが、 <code>kubernetes</code> を <code>openshift</code> に置き換えます。OpenShiftの先ほどの例は次のようになります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.openshift.env.fields.foo=metadata.name</code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4">
<h5 id="バリデーション"><a class="anchor" href="#バリデーション"></a>バリデーション</h5>
<div class="paragraph">
<p>例えば、誤って両方の値を代入したり、変数がフィールドから派生したものであることを指定したりするなど、2つの定義の間で競合が発生すると、ビルド時にエラーが発生します。そのため、問題の原因を診断するのが困難なクラスターにアプリケーションをデプロイする前に問題を修正する機会を得ることができます。</p>
</div>
<div class="paragraph">
<p>同様に、同じシークレットからのインジェクションを2回定義するなど、2つの冗長な定義があっても問題は発生しませんが、その定義を複製することを意図していなかった可能性があることを知らせる警告が実際に報告されます。</p>
</div>
</div>
<div class="sect4">
<h5 id="env-vars-backwards"><a class="anchor" href="#env-vars-backwards"></a>下位互換性</h5>
<div class="paragraph">
<p>Kubernetes エクステンションの以前のバージョンでは、環境変数を追加するための異なる構文をサポートしていました。古い構文はまだサポートされていますが、非推奨ですので、新しい構文に移行することをお勧めします。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. 古い構文と新しい構文</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">旧</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">新</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">素の変数</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env-vars.my-env-var.value=foobar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env.vars.my-env-var=foobar</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">フィールドから</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env-vars.my-env-var.field=foobar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env.fields.my-env-var=foobar</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">すべての <code>ConfigMap</code> から</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env-vars.xxx.configmap=foobar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env.configmaps=foobar</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">すべての <code>Secret</code> から</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env-vars.xxx.secret=foobar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env.secrets=foobar</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ある <code>Secret</code> フィールドから</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env-vars.foo.secret=foobar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env.mapping.foo.from-secret=foobar</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env-vars.foo.value=field</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env.mapping.foo.with-key=field</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ある <code>ConfigMap</code> フィールドから</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env-vars.foo.configmap=foobar</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env.mapping.foo.from-configmap=foobar</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env-vars.foo.value=field</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>quarkus.kubernetes.env.mapping.foo.with-key=field</code></p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
古い文法を残した状態で新しい文法を使って同じ変数を再定義した場合、 新しいバージョン <strong>のみ</strong> が保持され、問題を通知するために警告が発せられます。例えば、<code>quarkus.kubernetes.env-vars.my-env-var.value=foobar</code> と <code>quarkus.kubernetes.env.vars.my-env-var=newValue</code> の両方を定義した場合、エクステンションは環境変数 <code>MY_ENV_VAR=newValue</code> のみを生成して警告を発します。
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3">
<h4 id="ボリュームのマウント"><a class="anchor" href="#ボリュームのマウント"></a>ボリュームのマウント</h4>
<div class="paragraph">
<p>Kubernetes エクステンションを使用すると、アプリケーションのボリュームとマウントの両方を設定することができます。 簡単な設定で任意のボリュームをマウントすることができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.mounts.my-volume.path=/where/to/mount</code></pre>
</div>
</div>
<div class="paragraph">
<p>これにより、Pod のパス <code>/where/to/mount</code> にボリューム <code>my-volume</code> のマウントを追加します。 ボリューム自体は、以下のセクションに示すように設定することができます。</p>
</div>
<div class="sect4">
<h5 id="シークレットのボリューム"><a class="anchor" href="#シークレットのボリューム"></a>シークレットのボリューム</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.secret-volumes.my-volume.secret-name=my-secret</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="configmap-volumes"><a class="anchor" href="#configmap-volumes"></a>ConfigMap volumes</h5>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.config-map-volumes.my-volume.config-map-name=my-secret</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="アプリケーション設定の受け渡し"><a class="anchor" href="#アプリケーション設定の受け渡し"></a>アプリケーション設定の受け渡し</h4>
<div class="paragraph">
<p>Quarkusは、外部の場所から（Smallrye Config経由で）設定を渡すことをサポートしています。これには通常、追加の環境変数やシステムの適切性を設定する必要があります。 アプリケーションの設定の目的で Secret や ConfigMap を使用する必要がある場合は、以下のようにする必要があります。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>define a volume</p>
</li>
<li>
<p>mount the volume</p>
</li>
<li>
<p>create an environment variable for <code>SMALLRYE_CONFIG_LOCATIONS</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>物事を単純化するために、Quarkus はシングルステップの代替手段を提供しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.app-secret=&lt;name of the secret containing the configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.app-config-map=&lt;name of the config map containing the configuration&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>これらのプロパティを使用すると、生成されたマニフェストには必要なものがすべて含まれます。 アプリケーションのコンフィグボリュームは、Secret と ConfigMap にそれぞれパスを使用して作成されます。Secret と ConfigMap はそれぞれ <code>/mnt/app-secret</code> と <code>/mnt/app-config-map</code> を使用して作成されます。</p>
</div>
<div class="paragraph">
<p>注：ユーザーは両方のプロパティを同時に使用することができます。</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="レプリカ数を変更する"><a class="anchor" href="#レプリカ数を変更する"></a>レプリカ数を変更する</h3>
<div class="paragraph">
<p>レプリカ数を1から3に変更するためには次のようにします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.replicas=3</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="rediness-および-liveness-プローブを追加する"><a class="anchor" href="#rediness-および-liveness-プローブを追加する"></a>rediness および liveness プローブを追加する</h3>
<div class="paragraph">
<p>デフォルトでは、Kubernetesリソースは、生成された <code>Deployment</code> の中に readiness と liveness のプローブを含みません。しかし、これらを追加するには、以下のように SmallRye Health エクステンションを追加するだけです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">    &lt;dependency&gt;
      &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
      &lt;artifactId&gt;quarkus-smallrye-health&lt;/artifactId&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>生成されるプローブの値は、設定されたヘルスプロパティによって決定されます。<code>quarkus.smallrye-health.root-path</code>, <code>quarkus.smallrye-health.liveness-path</code>, <code>quarkus.smallrye-health.readiness-path</code> で決定されます。 health エクステンションの詳細については、関連リンク:microprofile-health[ガイド] を参照してください。</p>
</div>
</div>
<div class="sect2">
<h3 id="rediness-プローブのカスタマイズ"><a class="anchor" href="#rediness-プローブのカスタマイズ"></a>rediness プローブのカスタマイズ</h3>
<div class="paragraph">
<p>プローブの初期遅延を 20 秒、周期を 45 秒に設定します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.readiness-probe.initial-delay=20s
quarkus.kubernetes.readiness-probe.period=45s</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="hostaliases-の追加"><a class="anchor" href="#hostaliases-の追加"></a>hostAliases の追加</h3>
<div class="paragraph">
<p>Podの`/etc/hosts`ファイルにエントリを追加するには(詳細は <a href="https://kubernetes.io/docs/concepts/services-networking/add-entries-to-pod-etc-hosts-with-host-aliases/">Kubernetes documentation</a> )、以下の設定を適用するだけです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.hostaliases."10.0.0.0".hostnames=foo.com,bar.org</code></pre>
</div>
</div>
<div class="paragraph">
<p>これにより、<code>deployment`定義の中に以下の `hostAliases</code> セクションが生成されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">kind: Deployment
spec:
  template:
    spec:
      hostAliases:
      - hostnames:
        - foo.com
        - bar.org
        ip: 10.0.0.0</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="コンテナリソース管理"><a class="anchor" href="#コンテナリソース管理"></a>コンテナリソース管理</h3>
<div class="paragraph">
<p>CPUやメモリの制限やリクエストは、以下の設定で <code>Container</code> (詳細は <a href="https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/">Kubernetes documentation</a> を参照) に適用することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">quarkus.kubernetes.resources.requests.memory=64Mi
quarkus.kubernetes.resources.requests.cpu=250m
quarkus.kubernetes.resources.limits.memory=512Mi
quarkus.kubernetes.resources.limits.cpu=1000m</code></pre>
</div>
</div>
<div class="paragraph">
<p>これにより、`container`セクションに以下のエントリが生成されます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">containers:
  resources:
    limits:
      cpu: 1000m
      memory: 512Mi
    requests:
      cpu: 250m
      memory: 64Mi</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="using-the-kubernetes-client"><a class="anchor" href="#using-the-kubernetes-client"></a>Using the Kubernetes client</h3>
<div class="paragraph">
<p>Kubernetesにデプロイされ、APIサーバにアクセスする必要があるアプリケーションは、通常 <code>kubernetes-client</code> エクステンションを利用します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">    &lt;dependency&gt;
      &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
      &lt;artifactId&gt;quarkus-kubernetes-client&lt;/artifactId&gt;
    &lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Kubernetesクラスタ内からAPIサーバにアクセスするためには、RBAC関連のリソース(ServiceAccountやRoleBindingなど)が必要である。 そのため、<code>kubernetes-client</code> エクステンションが存在する場合、<code>kubernetes</code> エクステンションはこれらのリソースを自動的に作成し、アプリケーションに <code>view</code> ロールを付与します。 より多くのロールが必要な場合は、手動で追加しなければなりません。</p>
</div>
</div>
<div class="sect2">
<h3 id="deploying-to-minikube"><a class="anchor" href="#deploying-to-minikube"></a>Deploying to Minikube</h3>
<div class="paragraph">
<p><a href="https://github.com/kubernetes/minikube">Minikube</a> は、開発目的でKubernetesクラスタが必要な場合に非常に人気があります。Minikubeへのデプロイをできるだけ摩擦のないものにするために、Quarkusは <code>quarkus-minikube</code> エクステンションを提供しています。このエクステンションは、以下のようなプロジェクトに追加することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-minikube&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>このエクステンションの目的は、Minikube に合わせた Kubernetes マニフェスト (<code>minikube.yaml</code> と <code>minikube.json</code>) を生成することです。 このエクステンションはいくつかのことを前提としています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ユーザーはイメージレジストリを使用せず、コンテナイメージをMinikubeのDockerデーモンに直接ビルドしてKubernetesクラスタにアクセスできるようにします。MinikubeのDockerデーモンを使用するには、まず実行する必要があります。</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">eval $(minikube -p minikube docker-env)</code></pre>
</div>
</div>
</li>
<li>
<p>Kubernetesにデプロイされたアプリケーションは、Kubernetesの <code>Ingress</code> ではなく、<code>NodePort</code> <code>Service</code> としてアクセスされます。 この方法の利点は、アプリケーションのURLを実行することで、アプリケーションのURLを簡単に取得できることです。</p>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">minikube service list</code></pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>この場合に使用される <a href="https://kubernetes.io/docs/concepts/services-networking/service/#nodeport">nodePort</a> を制御するために、ユーザーは <code>quarkus.kubernetes.node-port</code> を設定することができます。 しかし、何も設定されていない場合、Quarkusは自動的に適切な（変更されない）値を使用するため、この設定は完全に任意であることに注意してください。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
本番環境へのデプロイ時に Minikube エクステンションで生成されたマニフェストを使用することはまったくお勧めできません。本番環境にデプロイする場合は、バニラ Kubernetes マニフェスト (または OpenShift をターゲットにしている場合は OpenShift マニフェスト) の使用を検討してください。
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Minikube エクステンションが想定している前提がワークフローに合わない場合、通常の Kubernetes エクステンションを使用して Kubernetes マニフェストを生成し、それを Minikube クラスタに適用することを妨げるものは何もありません。
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="application-properties-を使用して生成されたリソースをチューニングする"><a class="anchor" href="#application-properties-を使用して生成されたリソースをチューニングする"></a>application.properties を使用して生成されたリソースをチューニングする</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Kubernetes のエクステンションでは、<code>application.properties</code> ファイルを使用して生成されたマニフェストをチューニングすることができます。 ここではいくつかの例を紹介します。</p>
</div>
<div class="sect2">
<h3 id="設定オプション"><a class="anchor" href="#設定オプション"></a>設定オプション</h3>
<div class="paragraph">
<p>以下の表は、利用可能なすべての設定オプションについて説明しています。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Kubernetes</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">${quarkus.container-image.name}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">${quarkus.container-image.tag}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.part-of</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.init-containers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Container&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.namespace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.labels</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.annotations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.app-secret</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.app-config-map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.env-vars</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Env&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.working-dir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.command</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String[]</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.arguments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String[]</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.replicas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.service-account</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.ports</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Port&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.service-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ServiceType</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ClusterIP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.pvc-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, PersistentVolumeClaimVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.secret-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, SecretVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.config-map-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, ConfigMapVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.git-repo-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, GitRepoVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.aws-elastic-block-store-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, AwsElasticBlockStoreVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.azure-disk-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, AzureDiskVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.azure-file-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, AzureFileVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.mounts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Mount&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.image-pull-policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ImagePullPolicy</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.image-pull-secrets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String[]</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.liveness-probe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Probe</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">( see Probe )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.readiness-probe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Probe</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">( see Probe )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.sidecars</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Container&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.expose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.headless</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.hostaliases</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, HostAlias&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.resources.requests.cpu</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.resources.requests.memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">\</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.kubernetes.resources.limits.memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>非標準型を使用するプロパティーは、プロパティーを展開することで参照することができます。例えば、 <code>Probe</code> 型の <code>kubernetes-readiness-probe</code> を定義するには次のようにします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.readiness-probe.initial-delay=20s
quarkus.kubernetes.readiness-probe.period=45s</code></pre>
</div>
</div>
<div class="paragraph">
<p>この例では、 <code>initial-delay</code> と <code>period</code> は <code>Probe</code> タイプのフィールドです。以下に、利用可能なすべてのタイプを説明した表を示します。</p>
</div>
<div class="sect3">
<h4 id="基本的なタイプ"><a class="anchor" href="#基本的なタイプ"></a>基本的なタイプ</h4>
<div class="paragraph">
<div class="title">ServiceType</div>
<p>許可される値: <code>cluster-ip</code> , <code>node-port</code> , <code>load-balancer</code> . <code>external-name</code></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Env</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">値</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">secret</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">configmap</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">field</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 4. Probe</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">http-action-path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">exec-action</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tcp-socket-action</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">initial-delay</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">period</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">30s</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">timeout</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10s</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 5. Port</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">container-port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">host-port</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">/</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">protocol</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Protocol</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TCP</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 6. Container</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">image</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">env-vars</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Env[]</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">working-dir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">command</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String[]</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">arguments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String[]</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ports</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Port[]</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mounts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mount[]</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">image-pull-policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ImagePullPolicy</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">liveness-probe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Probe</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">readiness-probe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Probe</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 7. HostAlias</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">hostnames</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String[]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">list of hostnames</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="マウントとボリューム"><a class="anchor" href="#マウントとボリューム"></a>マウントとボリューム</h4>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 8. Mount</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sub-path</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">read-only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 9. ConfigMapVolume</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">config-map-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">default-mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0600</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 10. SecretVolume</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">secret-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">default-mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">0600</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 11. AzureDiskVolume</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">disk-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">disk-uri</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">kind</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Managed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">caching-mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ReadWrite</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fs-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ext4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">read-only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 12. AwsElasticBlockStoreVolume</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">volume-id</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">partition</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fs-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ext4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">read-only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 13. GitRepoVolume</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">repository</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">directory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">revision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 14. PersistentVolumeClaimVolume</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">claim-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">read-only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 15. AzureFileVolume</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">share-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">secret-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">read-only</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="openshift"><a class="anchor" href="#openshift"></a>OpenShift</h3>
<div class="paragraph">
<p>アプリケーションを OpenShift にデプロイする方法の1つとして、s2i(source to image)を使用してソースからイメージストリームを作成し、イメージストリームをデプロイする方法があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw quarkus:remove-extension -Dextensions="kubernetes, jib"
./mvnw quarkus:add-extension -Dextensions="openshift"

oc new-project quarkus-project
./mvnw clean package -Dquarkus.container-image.build=true

oc new-app --name=greeting  quarkus-project/kubernetes-quickstart:1.0.0-SNAPSHOT
oc expose svc/greeting
oc get route
curl &lt;route&gt;/greeting</code></pre>
</div>
</div>
<div class="paragraph">
<p>詳細は「 <a href="deploying-to-openshift">OpenShiftへのデプロイ</a> 」を参照してください。</p>
</div>
<div class="paragraph">
<p>OpenShiftリソースとカスタマイズ可能なプロパティーの説明を以下にKubernetesリソースと一緒に記載し、該当する場合には類似性を示します。これには、上記の <code>oc new-app …</code> の代替、すなわち <code>oc apply -f target/kubernetes/openshift.json</code> を含みます。</p>
</div>
<div class="paragraph">
<p>To enable the generation of OpenShift resources, you need to include OpenShift in the target platforms:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.deployment-target=openshift</code></pre>
</div>
</div>
<div class="paragraph">
<p>両方のプラットフォーム(バニラKubernetesとOpenShift)のリソースを生成する必要がある場合は、両方を含める必要があります(カンマ区切り)。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.deployment-target=kubernetes,openshift</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>./mvnw package -Dquarkus.container-image.build=true</code> の実行後に、 <code>target/kubernetes/</code> ディレクトリーに <code>openshift.json</code> と <code>openshift.yml</code> という名前の2つのファイルが作成されたことに気づくでしょう。</p>
</div>
<div class="paragraph">
<p>これらのマニフェストは、 <code>kubectl</code> を使用して、実行中のクラスターにそのままデプロイすることができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -f target/kubernetes/openshift.json</code></pre>
</div>
</div>
<div class="paragraph">
<p>OpenShiftユーザーは、 <code>kubectl</code> の代わりに <code>oc</code> を使用した方が良いかもしれません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">oc apply -f target/kubernetes/openshift.json</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Quarkusは <a href="deploying-to-openshift">OpenShift</a> エクステンションも提供しています。このエクステンションは基本的に Kubernetes エクステンションのラッパーであり、OpenShiftユーザーが <code>deployment-target</code> プロパティーを <code>openshift</code> に設定する必要性を緩和します。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Kubernetesと同様のアプローチでOpenShiftのリソースをカスタマイズすることができます。</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 16. OpenShift</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">${quarkus.container-image.name}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">${quarkus.container-image.tag}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.part-of</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.init-containers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Container&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.labels</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.annotations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.app-secret</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.app-config-map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.env-vars</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Env&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.working-dir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.command</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String[]</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.arguments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String[]</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.replicas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.service-account</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.ports</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Port&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.service-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ServiceType</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ClusterIP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.pvc-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, PersistentVolumeClaimVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.secret-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, SecretVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.config-map-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, ConfigMapVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.git-repo-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, GitRepoVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.aws-elastic-block-store-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, AwsElasticBlockStoreVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.azure-disk-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, AzureDiskVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.azure-file-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, AzureFileVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.mounts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Mount&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.image-pull-policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ImagePullPolicy</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.image-pull-secrets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String[]</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.liveness-probe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Probe</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">( see Probe )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.readiness-probe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Probe</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">( see Probe )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.sidecars</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Container&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.expose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.openshift.headless</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="knative"><a class="anchor" href="#knative"></a>Knative</h3>
<div class="paragraph">
<p>Knative リソースの生成を可能にするには、ターゲットプラットフォームに Knative を含める必要があります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.kubernetes.deployment-target=knative</code></pre>
</div>
</div>
<div class="paragraph">
<p><code>./mvnw package</code> の実行後、作成された他のファイルの中に <code>knative.json</code> と <code>knative.yml</code> という名前のファイルが <code>target/kubernetes/</code> ディレクトリーにあることに気づくでしょう。</p>
</div>
<div class="paragraph">
<p>どちらかのファイルを見ると、Knative <code>Service</code> が含まれることが確認できます。</p>
</div>
<div class="paragraph">
<p><code>knative.json</code> ファイルの完全なソースはこんな感じです。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{
  {
    "apiVersion" : "serving.quarkus.knative.dev/v1alpha1",
    "kind" : "Service",
    "metadata" : {
      "annotations": {
       "app.quarkus.io/vcs-url" : "&lt;some url&gt;",
       "app.quarkus.io/commit-id" : "&lt;some git SHA&gt;"
      },
      "labels" : {
        "app.kubernetes.io/name" : "test-quarkus-app",
        "app.kubernetes.io/version" : "1.0.0-SNAPSHOT"
      },
      "name" : "knative.
    },
    "spec" : {
      "runLatest" : {
        "configuration" : {
          "revisionTemplate" : {
            "spec" : {
              "container" : {
                "image" : "dev.local/yourDockerUsername/test-quarkus-app:1.0.0-SNAPSHOT",
                "imagePullPolicy" : "Always"
              }
            }
          }
        }
      }
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>生成されたマニフェストは、 <code>kubectl</code> を使用して、実行中のクラスターにそのままデプロイすることができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">kubectl apply -f target/kubernetes/knative.json</code></pre>
</div>
</div>
<div class="paragraph">
<p>生成されたサービスは、以下のプロパティーを使用してカスタマイズすることができます:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 17. Knative</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">${quarkus.container-image.name}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.version</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">${quarkus.container-image.tag}</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.part-of</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.init-containers</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Container&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.labels</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.annotations</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.app-secret</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.app-config-map</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.env-vars</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Env&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.working-dir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.command</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String[]</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.arguments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String[]</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.replicas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">1</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.service-account</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.host</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.ports</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Port&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.service-type</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ServiceType</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ClusterIP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.pvc-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, PersistentVolumeClaimVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.secret-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, SecretVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.config-map-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, ConfigMapVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.git-repo-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, GitRepoVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.aws-elastic-block-store-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, AwsElasticBlockStoreVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.azure-disk-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, AzureDiskVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.azure-file-volumes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, AzureFileVolume&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.mounts</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Mount&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.image-pull-policy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ImagePullPolicy</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Always</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.image-pull-secrets</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String[]</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.liveness-probe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Probe</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">( see Probe )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.readiness-probe</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Probe</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">( see Probe )</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.sidecars</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Map&lt;String, Container&gt;</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.revision-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">quarkus.knative.traffic</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Traffic[]</p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">( see Traffic)</p></td>
</tr>
</tbody>
</table>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 18. Traffic</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">プロパティー</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">タイプ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">説明</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">デフォルト値</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">revision-name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A specific revision to which to send this portion of traffic</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tag</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">String</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">このターゲットを参照するための専用URLを公開します。</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">latest-revision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Boolean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">この Traffic ターゲットに最新のリビジョンを使用することを示すためにオプションで提供される</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">false</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">percent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">このリビジョンにルーティングされる Traffic の割合を示します。</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">100</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="デプロイメントターゲット"><a class="anchor" href="#デプロイメントターゲット"></a>デプロイメントターゲット</h3>
<div class="paragraph">
<p>前のセクションで述べたのは <code>deployment-target</code> という概念です。この概念により、ユーザーはどの Kubernetes マニフェストを生成してクラスターにデプロイするかを制御することができます ( <code>quarkus.kubernetes.deploy</code> が <code>true</code> に設定されている場合)。</p>
</div>
<div class="paragraph">
<p>デフォルトでは、 <code>deployment-target</code> が設定されていない場合は、バニラ Kubernetes リソースのみが生成され、デプロイされます。複数の値が設定されている場合 (例: <code>quarkus.kubernetes.deployment-target=kubernetes,openshift</code> )、すべてのターゲットのリソースが生成されますが、 <strong>最初</strong> のターゲットに対応するリソースのみがクラスターに適用されます (デプロイが有効な場合)。</p>
</div>
<div class="paragraph">
<p>OpenShiftやMinikubeのようなラッパーエクステンションの場合、これらのエクステンションがプロジェクトに明示的に追加されているときは、それらのエクステンションによってデフォルトの <code>deployment-target</code> が設定されます。例えば、 <code>quarkus-minikube</code> がプロジェクトに追加されている場合、 <code>minikube</code> がデフォルトのデプロイメントターゲットになり、 <code>quarkus.kubernetes.deploy</code> 経由のデプロイメントが設定されていると、そのリソースが Kubernetes クラスターに適用されます。ユーザーは、 <code>quarkus.kubernetes.deployment-target</code> を使用して手動でディプロイメント ターゲットを上書きすることもできます。</p>
</div>
</div>
<div class="sect2">
<h3 id="非推奨の設定"><a class="anchor" href="#非推奨の設定"></a>非推奨の設定</h3>
<div class="paragraph">
<p>以下のカテゴリの構成プロパティーは非推奨となりました。</p>
</div>
<div class="sect3">
<h4 id="quarkus接頭辞のないプロパティー"><a class="anchor" href="#quarkus接頭辞のないプロパティー"></a>quarkus接頭辞のないプロパティー</h4>
<div class="paragraph">
<p>以前のバージョンのエクステンションでは、これらのプロパティーに <code>quarkus.</code> がありませんでした。これらのプロパティーは現在非推奨となっています。</p>
</div>
</div>
<div class="sect3">
<h4 id="docker-and-s2i-properties"><a class="anchor" href="#docker-and-s2i-properties"></a>Docker and S2i properties</h4>
<div class="paragraph">
<p><code>docker</code> と <code>s2i</code> を設定するためのプロパティーも非推奨となり、新しいコンテナーイメージエクステンションが採用されました。</p>
</div>
</div>
<div class="sect3">
<h4 id="コンフィググループ配列"><a class="anchor" href="#コンフィググループ配列"></a>コンフィググループ配列</h4>
<div class="paragraph">
<p>コンフィググループ配列を参照するプロパティー(例: <code>kubernetes.labels[0]</code> 、 <code>kubernetes.env-vars[0]</code> など)は、Quarkusのエコシステムの他の部分と一致するようにマップに変換されました。</p>
</div>
<div class="paragraph">
<p>以下のコードは <code>labels</code> の設定を変更した様子を示しています:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># Old labels config:
kubernetes.labels[0].name=foo
kubernetes.labels[0].value=bar

# New labels
quarkus.kubernetes.labels.foo=bar</code></pre>
</div>
</div>
<div class="paragraph">
<p>以下のコードは <code>env-vars</code> の設定を変更した様子を示しています:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties"># Old env-vars config:
kubernetes.env-vars[0].name=foo
kubernetes.env-vars[0].configmap=my-configmap

# New env-vars
quarkus.kubernetes.env-vars.foo.configmap=myconfigmap</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="env-vars-properties"><a class="anchor" href="#env-vars-properties"></a><code>env-vars</code> properties</h4>
<div class="paragraph">
<p><code>quarkus.kubernetes.env-vars</code> は非推奨です(この記事を書いている時点ではまだサポートされていますが)ので、代わりに新しい宣言スタイルを使うべきです。詳細は <a href="#env-vars">[env-vars</a>] とより具体的には <a href="#env-vars-backwards">[env-vars-backwards</a> を] 参照してください。</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="デプロイメント"><a class="anchor" href="#デプロイメント"></a>デプロイメント</h2>
<div class="sectionbody">
<div class="paragraph">
<p>コンテナーイメージをビルドしてデプロイするには、 <code>quarkus.kubernetes.deploy</code> フラグを有効にする必要があります (このフラグはデフォルトでは無効になっています - さらに、テスト実行中や開発モードでは何の効果もありません)。これはコマンドラインで簡単に行えます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw clean package -Dquarkus.kubernetes.deploy=true</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="コンテナーイメージのビルド"><a class="anchor" href="#コンテナーイメージのビルド"></a>コンテナーイメージのビルド</h3>
<div class="paragraph">
<p>コンテナーイメージのビルドは、利用可能な3つの <code>container-image</code> エクステンションのいずれかを使用して可能です。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="container-image#docker">Docker</a></p>
</li>
<li>
<p><a href="container-image#jib">Jib</a></p>
</li>
<li>
<p><a href="container-image#s2i">s2i</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>デプロイが要求されるたびに、暗黙のうちにコンテナーイメージのビルドがトリガーされます(Kubernetes のデプロイが有効になっている場合は、追加のプロパティーは必要ありません)。</p>
</div>
</div>
<div class="sect2">
<h3 id="デプロイ"><a class="anchor" href="#デプロイ"></a>デプロイ</h3>
<div class="paragraph">
<p>デプロイを有効にすると、Kubernetes エクステンションは <code>quarkus.kubernetes.deployment.target</code> で指定されたリソースを選択してデプロイします。これは、ターゲットの Kubernetes クラスターを指す <code>.kube/config</code> がユーザーディレクトリーで利用可能であることを前提としています。言い換えれば、エクステンションは <code>kubectl</code> が使用しているクラスターを使用します。クレデンシャルについても同様です。</p>
</div>
<div class="paragraph">
<p>現在のところ、さらなるカスタマイズのための追加オプションは提供されていません。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="既存のリソースの利用"><a class="anchor" href="#既存のリソースの利用"></a>既存のリソースの利用</h2>
<div class="sectionbody">
<div class="paragraph">
<p>時には、追加のリソース(例えば、ConfigMap、Secret、データベースのデプロイメントなど)を提供するか、生成プロセスのために <code>base</code> として使用されるカスタムのリソースを提供することが望ましい場合があります。これらのリソースは <code>src/main/kubernetes</code> ディレクトリーの下に追加することができ、ターゲット環境にちなんだ名前をつけることができます (例: kubernetes.json、openshift.json、knative.json、または yml 等価のもの)。これらのファイルのそれぞれには、1つ以上のKubernetesリソースが含まれている可能性があります。</p>
</div>
<div class="paragraph">
<p>見つかったリソースは、生成されたマニフェストに追加されます。グローバルな変更(ラベルや注釈など)は、それらのリソースにも適用されます。提供されたリソースの一つが、生成されたリソースの一つと同じ名前を持つ場合、生成されたリソースは提供されたリソースの上に作成され、可能な限り既存のコンテンツ(既存のラベル、アノテーション、環境変数、マウント、レプリカなど)を尊重します。</p>
</div>
<div class="paragraph">
<p>リソースの名前はアプリケーション名によって決定され、 <code>quarkus.kubernetes.name</code> 、 <code>quarkus.openshift.name</code> 、 <code>quarkus.knative.name</code> で上書きすることができます。</p>
</div>
<div class="paragraph">
<p>例えば、 <code>kubernetes-quickstart</code> アプリケーションでは、 <code>src/main/kubernetes</code> の中に <code>kubernetes.yml</code> のようなファイルを追加することができます。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: apps/v1
kind: Deployment
metadata:
  name: kubernetes-quickstart
  labels:
    app: quickstart
spec:
  replicas: 3
  selector:
    matchLabels:
      app: quickstart
  template:
    metadata:
      labels:
        app: quickstart
    spec:
      containers:
      - name: kubernetes-quickstart
        image: someimage:latest
        ports:
        - containerPort: 80
        env:
        - name: FOO
          value: BAR</code></pre>
</div>
</div>
<div class="paragraph">
<p>生成された <code>kubernetes.yml</code> は以下のようになります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">apiVersion: "apps/v1"
kind: "Deployment"
metadata:
  annotations:
    app.quarkus.io/build-timestamp: "2020-04-10 - 12:54:37 +0000"
  labels:
    app: "quickstart"
  name: "kubernetes-quickstart"
spec:
  replicas: 3 <i class="conum" data-value="1"></i><b>(1)</b>
  selector:
    matchLabels:
      app.kubernetes.io/name: "kubernetes-quickstart"
      app.kubernetes.io/version: "1.0.0-SNAPSHOT"
  template:
    metadata:
      annotations:
        app.quarkus.io/build-timestamp: "2020-04-10 - 12:54:37 +0000"
      labels:
        app: "quickstart" <i class="conum" data-value="2"></i><b>(2)</b>
    spec:
      containers:
      - env:
        - name: "FOO" <i class="conum" data-value="3"></i><b>(3)</b>
          value: "BAR"
        image: "&lt;&lt;yourDockerUsername&gt;&gt;/kubernetes-quickstart:1.0.0-SNAPSHOT" <i class="conum" data-value="4"></i><b>(4)</b>
        imagePullPolicy: "Always"
        name: "kubernetes-quickstart"
        ports:
        - containerPort: 8080 <i class="conum" data-value="5"></i><b>(5)</b>
          name: "http"
          protocol: "TCP"
      serviceAccount: "kubernetes-quickstart"</code></pre>
</div>
</div>
<div class="paragraph">
<p>提供されたレプリカ &lt;1&gt;, ラベル &lt;2&gt;, 環境変数 &lt;3&gt; はそのまま引き継がれました。ただし、イメージ &lt;4&gt; とコンテナーポート &lt;5&gt; は変更されました。また、デフォルトのアノテーションが追加されました。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>リソース名がアプリケーション名(またはオーバーライドされた名前)と一致しない場合は、リソースを再利用する代わりに新しいリソースが追加されます。コンテナーについても同様です。コンテナーの名前がアプリケーション名 (またはオーバーライドされた名前) と一致しない場合、コンテナー固有の設定は無視されます。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
    </div>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus はオープンです。このプロジェクトの全ての依存関係は<a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a>または互換性のあるライセンスの元で利用出来ます。<br /><br />このウェブサイトは <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a> で構築されており、<a href='https://pages.github.com/' target='_blank'>Github Pages</a>にホストされており、完全にオープンソースです。改善したい場合、 <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>ウェブサイトをフォークし</a>、修正してみせてください。</p>

    
      <div class="width-1-12 project-links">
        <span>ナビゲーション</span>
        <ul class="footer-links">
          
            <li><a href="/">ホーム</a></li>
          
            <li><a href="/about">Quarkusについて</a></li>
          
            <li><a href="/blog">ブログ</a></li>
          
            <li><a href="/insights">ポッドキャスト</a></li>
          
            <li><a href="/events">イベント</a></li>
          
            <li><a href="/newsletter">ニュースレター</a></li>
          
            <li><a href="/publications">出版</a></li>
          
            <li><a href="/awards">受賞</a></li>
          
            <li><a href="/security">セキュリティポリシー</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>フォロー</span>
        <ul class="footer-links">
          
            <li><a href="https://twitter.com/quarkusio">Twitter</a></li>
          
            <li><a href="https://www.facebook.com/quarkusio">Facebook</a></li>
          
            <li><a href="https://www.linkedin.com/company/quarkusio/">Linkedin</a></li>
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg">Youtube</a></li>
          
            <li><a href="https://github.com/quarkusio">GitHub</a></li>
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>ヘルプ</span>
        <ul class="footer-links">
          
            <li><a href="/support">サポート</a></li>
          
            <li><a href="/guides">ガイド</a></li>
          
            <li><a href="/faq">FAQ</a></li>
          
            <li><a href="/get-started">入門</a></li>
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus">Stack Overflow</a></li>
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions">ディスカッション</a></li>
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev">開発メーリングリスト</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Languages</span>
        <ul class="footer-links">
          
            <li><a href="https://quarkus.io/">English</a></li>
          
            <li><a href="https://ja.quarkus.io/">Japanese</a></li>
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkusはコミュニティプロジェクトで構成されています：</span>
        <ul class="footer-links">
          
            <li><a href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a href="https://code.quarkus.io/" target="_blank">等々...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/search-filter.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
</body>

</html>
