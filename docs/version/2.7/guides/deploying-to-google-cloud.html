<!DOCTYPE html>
<html>





<head>
  <title>Quarkus - Deploying to Google Cloud Platform (GCP) - 2.7</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="default-src https://dpm.demdex.net; script-src 'self' 'unsafe-eval' 'sha256-ANpuoVzuSex6VhqpYgsG25OHWVA1I+F6aGU04LoI+5s=' 'sha256-ipy9P/3rZZW06mTLAR0EnXvxSNcnfSDPLDuh3kzbB1w=' js.bizographics.com https://www.redhat.com https://static.redhat.com assets.adobedtm.com jsonip.com https://ajax.googleapis.com https://www.googletagmanager.com https://www.google-analytics.com https://use.fontawesome.com https://app.mailjet.com http://www.youtube.com http://www.googleadservices.com https://googleads.g.doubleclick.net https://dpm.demdex.net https://giscus.app; style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; img-src 'self' *; media-src 'self'; frame-src https://www.googletagmanager.com https://www.youtube.com https://embed.restream.io https://app.mailjet.com https://giscus.app; base-uri 'none'; object-src 'none'; form-action 'none'; font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/version/2.7/guides/deploying-to-google-cloud" />
  <meta property="og:title" content="Deploying to Google Cloud Platform (GCP) - 2.7" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/deploying-to-google-cloud">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/goan.js" type="text/javascript"></script>
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
</head>

<body class="guides">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJWS5L"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
  <div class="container">
    <div class="logo-wrapper">
        <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
    </div>
    <label class="nav-toggle" for="checkbox"> <i class="fa fa-bars"></i>
</label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="/about/">Quarkusとは <i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">QUARKUSとは何か?</a></li>
          <li><a href="/container-first" class="">コンテナ・ファースト</a></li>
          <li><a href="/continuum" class="">リアクティブ</a></li>
          <li><a href="/developer-joy" class="">開発者満足</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">標準</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/learn/">学ぶ<i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">入門</a></li>
          <li><a href="/guides" class="active">ガイド</a></li>
          <li><a href="/qtips" class="">"Q" Tipsビデオ</a></li>          
          <li><a href="/books" class="">書籍</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="/community/">コミュニティ <i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">サポート</a></li>
          <li><a href="/blog" class="">ブログ</a></li>
          <li><a href="/discussion" class="">ディスカッション</a></li>
          <li><a href="/insights" class="">ポッドキャスト</a></li>
          <li><a href="/events" class="">イベント</a></li>
          <li><a href="/newsletter" class="">ニュースレター</a></li>
          <li><a href="/publications" class="">出版物</a></li>
          <li><a href="/awards" class="">受賞</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary
white">コーディングを開始</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/" >ENGLISH</a></li>
          <li><a href="https://ja.quarkus.io/">JAPANESE</a></li>
          </ul>
      </li>
    </ul>
  </div>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    



<div class="full-width-version-bg grey align-self">
  <div class="grid-wrapper">
    <div class="grid__item width-6-12">
      <p class="returnlink"><i class="fas fa-angle-left"></i><a href="/version/2.7/guides/"> Back to Guides</a></p>
    </div>
    <div class="grid__item width-6-12 align-self-center text-right hide-mobile">
      <label id="guide-version-label">Select Guide Version</label>
      <select id="guide-version-dropdown">
        
      
        
        
        
        
          
        <option value="main" >Main - SNAPSHOT</option>
        
        
      
        
        
        
        
          
        <option value="latest" >2.9 - Latest</option>
        
        
      
        
        
        
        
          
        <option value="2.7" selected>2.7</option>
        
        
      
        
        
        
        
          
        <option value="2.2" >2.2</option>
        
        
      
        
        
        
        
          
        <option value="1.11" >1.11</option>
        
        
      
    
      </select>
    </div>
  </div>
</div>

<div class="grid-wrapper guide">
  <div class="grid__item width-12-12 width-12-12-mobile">
    <h1 class="text-caps">Deploying to Google Cloud Platform (GCP) </h1>
  </div>
  <div class="width-12-12">
    <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#前提条件">前提条件</a></li>
<li><a href="#login-to-google-cloud">Login to Google Cloud</a></li>
<li><a href="#deploying-to-google-cloud-functions">Deploying to Google Cloud Functions</a></li>
<li><a href="#deploying-to-google-app-engine-standard">Deploying to Google App Engine Standard</a>
<ul class="sectlevel2">
<li><a href="#アプリケーションを手動でビルドする">アプリケーションを手動でビルドする</a></li>
<li><a href="#gcloud-経由でアプリケーションをビルドする">gcloud 経由でアプリケーションをビルドする</a></li>
<li><a href="#building-the-application-via-the-google-cloud-maven-plugin">Building the application via the Google Cloud Maven plugin</a></li>
</ul>
</li>
<li><a href="#deploying-to-google-app-engine-flexible-custom-runtimes">Deploying to Google App Engine Flexible Custom Runtimes</a></li>
<li><a href="#deploying-to-google-cloud-run">Deploying to Google Cloud Run</a></li>
<li><a href="#using-cloud-sql">Using Cloud SQL</a>
<ul class="sectlevel2">
<li><a href="#using-cloud-sql-with-a-jdbc-driver">Using Cloud SQL with a JDBC driver</a></li>
<li><a href="#リアクティブsqlクライアントでのcloud-sqlの使用">リアクティブSQLクライアントでのCloud SQLの使用</a></li>
</ul>
</li>
<li><a href="#さらに詳しく">さらに詳しく</a></li>
</ul></div>
    <div>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>このガイドでは以下をカバーしています:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Login to Google Cloud</p>
</li>
<li>
<p>Deploying a function to Google Cloud Functions</p>
</li>
<li>
<p>Deploying a JAR to Google App Engine Standard</p>
</li>
<li>
<p>Deploying a Docker image to Google App Engine Flexible Custom Runtimes</p>
</li>
<li>
<p>Deploying a Docker image to Google Cloud Run</p>
</li>
<li>
<p>Using Cloud SQL</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="前提条件"><a class="anchor" href="#前提条件"></a>前提条件</h2>
<div class="sectionbody">
<div class="paragraph">
<p>このガイドを完成させるには、以下が必要です:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ざっと 1 hour for all modalities</p>
</li>
<li>
<p>An IDE</p>
</li>
<li>
<p>JDK 11+ がインストールされ、 <code>JAVA_HOME</code> が適切に設定されていること</p>
</li>
<li>
<p>Apache Maven 3.8.1+</p>
</li>
<li>
<p>使用したい場合、 <a href="cli-tooling.html">Quarkus CLI</a></p>
</li>
<li>
<p><a href="https://cloud.google.com/">Googleクラウドのアカウント</a> 。無料アカウントでも大丈夫です。</p>
</li>
<li>
<p><a href="https://cloud.google.com/sdk">Cloud SDK CLI Installed</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>このガイドでは、 <a href="getting-started">入門ガイド</a> で開発されたアプリケーションを入力として使用します。</p>
</div>
<div class="paragraph">
<p>手元に get-started アプリケーションがあることを確認するか、Git リポジトリをクローンします: <code>git clone <a href="https://github.com/quarkusio/quarkus-quickstarts.git" class="bare">https://github.com/quarkusio/quarkus-quickstarts.git</a></code> 、もしくは <a href="https://github.com/quarkusio/quarkus-quickstarts/archive/main.zip">archive</a> をダウンロードしてください。ソリューションは <code>getting-started</code> ディレクトリーにあります。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="login-to-google-cloud"><a class="anchor" href="#login-to-google-cloud"></a>Login to Google Cloud</h2>
<div class="sectionbody">
<div class="paragraph">
<p>アプリケーションのデプロイにはGoogle Cloudへのログインが必要で、以下のように行います。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">gcloud auth login</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-to-google-cloud-functions"><a class="anchor" href="#deploying-to-google-cloud-functions"></a>Deploying to Google Cloud Functions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkusは、次のエクステンションを使用して、アプリケーションをGoogle Cloud Functionsにデプロイすることをサポートしています。</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="gcp-functions">Google Cloud Functions</a>: Google Cloud Functions APIを使用してファンクションを構築</p>
</li>
<li>
<p><a href="gcp-functions-http">Google Cloud Functions HTTP binding</a>: Quarkus HTTP API: RESTEasy（JAX-RS）、Undertow（Servlet）、Vert.x Web、または <a href="funqy-http.html">Funqy HTTP</a> を使用してファンクションを構築します。</p>
</li>
<li>
<p><a href="funqy-gcp-functions">Funky Google Cloud Functions</a>: Funqyを使って関数をビルド</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>各エクステンションは特定の種類のアプリケーション開発をサポートしており、それらを使用してアプリケーションを開発、パッケージ化、デプロイする方法の詳細については、特定のガイドに従ってください。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-to-google-app-engine-standard"><a class="anchor" href="#deploying-to-google-app-engine-standard"></a>Deploying to Google App Engine Standard</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Java 8 ランタイムはQuarkusと互換性のない独自のサーブレットエンジンを使用しているため、Java 11 ランタイムのみをカバーします。</p>
</div>
<div class="paragraph">
<p><code>gcloud app create --project=[YOUR_PROJECT_ID]</code> まず最初に、Google Cloud プロジェクト用に App Engine 環境が初期化されていることを確認します。</p>
</div>
<div class="paragraph">
<p>次に、 <code>src/main/appengine/app.yaml</code> ファイルを作成する必要がありますが、選択したエンジンだけで最低限のものにしておきましょう。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">runtime: java11</code></pre>
</div>
</div>
<div class="paragraph">
<p>これにより、App Engineアプリケーションのデフォルトサービスが作成されます。</p>
</div>
<div class="paragraph">
<p>App Engine Standard does not support the default Quarkus' specific packaging layout, therefore, you must set up your application to be packaged as an uber-jar via your <code>application.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.package.type=uber-jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then, you can choose to build the application manually or delegating that responsibility to <code>gcloud</code> or the Google Cloud Maven plugin.</p>
</div>
<div class="sect2">
<h3 id="アプリケーションを手動でビルドする"><a class="anchor" href="#アプリケーションを手動でビルドする"></a>アプリケーションを手動でビルドする</h3>
<div class="paragraph">
<p><code>mvn clean package</code> を使用してアプリケーションをビルドするために Maven を使用します。依存関係を含むアプリケーションのすべてのクラスを含む単一の JAR を生成します。</p>
</div>
<div class="paragraph">
<p>最後に、 <code>gcloud</code> を使用して、アプリケーションを App Engine サービスとしてデプロイします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">gcloud app deploy target/getting-started-1.0.0-SNAPSHOT-runner.jar</code></pre>
</div>
</div>
<div class="paragraph">
<p>このコマンドは、アプリケーション jar をアップロードし、App Engine で起動します。</p>
</div>
<div class="paragraph">
<p>When it’s done, the output will display the URL of your application (target url), you can use it with curl or directly open it in your browser using <code>gcloud app browse</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="gcloud-経由でアプリケーションをビルドする"><a class="anchor" href="#gcloud-経由でアプリケーションをビルドする"></a>gcloud 経由でアプリケーションをビルドする</h3>
<div class="paragraph">
<p><code>gcloud</code> にアプリケーションをビルドさせることができます。これは App Engine にデプロイする最もシンプルな方法です。</p>
</div>
<div class="paragraph">
<p>Then, you can just launch <code>gcloud app deploy</code> in the root of your project, it will upload all your project files (the list can be reduced via the <code>.gcloudignore</code> file), package your JAR via Maven (or Gradle) and launch it on App Engine.</p>
</div>
<div class="paragraph">
<p>When it’s done, the output will display the URL of your application (target url), you can use it with curl or directly open it in your browser using <code>gcloud app browse</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="building-the-application-via-the-google-cloud-maven-plugin"><a class="anchor" href="#building-the-application-via-the-google-cloud-maven-plugin"></a>Building the application via the Google Cloud Maven plugin</h3>
<div class="paragraph">
<p>また、App Engine Mavenプラグインを使用して、Mavenでアプリケーションのデプロイを制御することもできます。</p>
</div>
<div class="paragraph">
<p>まず、プラグインを <code>pom.xml</code> に追加します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;plugin&gt;
    &lt;groupId&gt;com.google.cloud.tools&lt;/groupId&gt;
    &lt;artifactId&gt;appengine-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;2.4.0&lt;/version&gt;
    &lt;configuration&gt;
        &lt;projectId&gt;GCLOUD_CONFIG&lt;/projectId&gt; <i class="conum" data-value="1"></i><b>(1)</b>
        &lt;version&gt;gettingstarted&lt;/version&gt;
        &lt;artifact&gt;${project.build.directory}/${project.artifactId}-${project.version}-runner.jar&lt;/artifact&gt; <i class="conum" data-value="2"></i><b>(2)</b>
    &lt;/configuration&gt;
&lt;/plugin&gt;</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>デフォルトの <code>gcloud</code> 設定を使用します。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>デフォルトのJAR名を、Quarkus Mavenプラグインによって生成されたものにオーバーライドします。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>その後、Mavenを使用してアプリケーションをビルドし、 <code>mvn clean package appengine:deploy</code> を経由してApp Engineにデプロイすることができます。</p>
</div>
<div class="paragraph">
<p>それが完了すると、出力にはアプリケーションの URL (ターゲット URL) が表示されます。curlを使うか、 <code>gcloud app browse</code> を使ってブラウザで直接開くことができます。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-to-google-app-engine-flexible-custom-runtimes"><a class="anchor" href="#deploying-to-google-app-engine-flexible-custom-runtimes"></a>Deploying to Google App Engine Flexible Custom Runtimes</h2>
<div class="sectionbody">
<div class="paragraph">
<p>まずはじめに、Google Cloud プロジェクト用に App Engine 環境が初期化されていることを確認してください。もしまだであれば、 <code>gcloud app create --project=[YOUR_PROJECT_ID]</code> によって初期化してください。</p>
</div>
<div class="paragraph">
<p>App Engine Flexible Custom RuntimesはDockerイメージを使用してアプリケーションを実行します。</p>
</div>
<div class="paragraph">
<p>まず、プロジェクトのルートに以下の内容の <code>app.yaml</code> ファイルを作成します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-yaml hljs" data-lang="yaml">runtime: custom
env: flex</code></pre>
</div>
</div>
<div class="paragraph">
<p>App Engine Flexible Custom Runtimesは、アプリケーションをDockerコンテナーとしてデプロイしますが、アプリケーション内で提供されるDockerfileのいずれかを選択してデプロイすることができます。</p>
</div>
<div class="paragraph">
<p>JVM版とネイティブ実行可能ファイル版の両方が動作します。</p>
</div>
<div class="paragraph">
<p>JVMアプリケーションをデプロイするには</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JVMのDockerfileをプロジェクトのルートディレクトリーにコピーします: <code>cp src/main/docker/Dockerfile.jvm Dockerfile</code> .</p>
</li>
<li>
<p><code>mvn clean package</code> を使用してアプリケーションを構築します。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>ネイティブアプリケーションをデプロイするには</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ネイティブのDockerfileをプロジェクトのルートディレクトリーにコピーします: <code>cp src/main/docker/Dockerfile.native Dockerfile</code> .</p>
</li>
<li>
<p><code>mvn clean package -Dnative</code> を使用して、アプリケーションをネイティブ実行可能ファイルとしてビルドします。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>最後に、プロジェクトのルートで <code>gcloud app deploy</code> を起動すると、すべてのプロジェクトファイルをアップロードし( <code>.gcloudignore</code> ファイルを介してリストを縮小することができます)、Dockerfile をビルドし、App Engine Flexible カスタムランタイム上で起動します。</p>
</div>
<div class="paragraph">
<p>Cloud Buildを使用してDockerイメージをビルドし、Google Container Registry(GCR)にデプロイします。</p>
</div>
<div class="paragraph">
<p>完了すると、出力にはアプリケーションの URL (ターゲット URL) が表示されます。curlを使うか、 <code>gcloud app browse</code> を使ってブラウザで直接開くことができます。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
App Engine Flexible custom runtimes support <a href="https://cloud.google.com/appengine/docs/flexible/custom-runtimes/configuring-your-app-with-app-yaml#updated_health_checks">health checks</a>, it is strongly advised to provide them thanks to Quarkus <a href="microprofile-health">Microprofile Health</a> support.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="deploying-to-google-cloud-run"><a class="anchor" href="#deploying-to-google-cloud-run"></a>Deploying to Google Cloud Run</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Google Cloud Runでは、Google Cloud Platform内でDockerコンテナーをマネージドな方法で実行することができます。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
デフォルトでは、Quarkusは8080番ポートをリッスンし、これはCloud Runのデフォルトポートでもあります。Cloud Runで定義された環境変数 <code>PORT</code> を使用して、QuarkusのHTTPポートをカスタマイズする必要はありません。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Cloud RunはCloud Buildを使用してDockerイメージを構築し、Google Container Registry(GCR)にデプロイします。</p>
</div>
<div class="paragraph">
<p>JVM版とネイティブ実行可能ファイル版の両方が動作します。</p>
</div>
<div class="paragraph">
<p>JVMアプリケーションをデプロイするには</p>
</div>
<div class="ulist">
<ul>
<li>
<p>JVMのDockerfileをプロジェクトのルートディレクトリーにコピーします: <code>cp src/main/docker/Dockerfile.jvm Dockerfile</code> .</p>
</li>
<li>
<p><code>mvn clean package</code> を使用してアプリケーションを構築します。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>ネイティブアプリケーションをデプロイするには</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ネイティブのDockerfileをプロジェクトのルートディレクトリーにコピーします: <code>cp src/main/docker/Dockerfile.native Dockerfile</code> .</p>
</li>
<li>
<p><code>mvn clean package -Dnative</code> を使用して、アプリケーションをネイティブ実行可能ファイルとしてビルドします。</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>次に、Cloud Buildのためにアップロードすべきでないファイルをgcloudに伝えるための <code>.gcloudignore</code> ファイルを作成します。これがない場合、デフォルトは <code>.gitignore</code> で、通常はパッケージ化されたアプリケーションが作成されたターゲットディレクトリーを除外します。</p>
</div>
<div class="paragraph">
<p>この例では、 <code>src</code> ディレクトリーだけを除外しています。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">src/</code></pre>
</div>
</div>
<div class="paragraph">
<p>その後、Cloud Buildを使ってイメージをビルドすると、アプリケーションのすべてのファイル(`.gcloudignore`fileで無視されたファイルを除く)をGoogle Cloud Storageバケットにアップロードし、DockerイメージをビルドしてGoogle Container Registry (GCR)にプッシュします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">gcloud builds submit --tag gcr.io/PROJECT-ID/helloworld</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
また、イメージをローカルにビルドして、公開されているDockerレジストリーにプッシュし、次のステップでこのイメージを使用することもできます。
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>最後に、Cloud Runを使ってアプリケーションを起動します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-shell script hljs" data-lang="shell script">gcloud run deploy --image gcr.io/PROJECT-ID/helloworld --platform managed</code></pre>
</div>
</div>
<div class="paragraph">
<p>Cloud run は、サービス名、リージョン、認証されていない呼び出しが許可されているかどうかについて質問をします。これらの質問に答えると、アプリケーションがデプロイされます。</p>
</div>
<div class="paragraph">
<p>デプロイが完了すると、出力にはアプリケーションにアクセスするためのURLが表示されます。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="using-cloud-sql"><a class="anchor" href="#using-cloud-sql"></a>Using Cloud SQL</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Google Cloud SQL provides managed instances for MySQL, PostgreSQL and Microsoft SQL Server. Quarkus has support for all three databases.</p>
</div>
<div class="sect2">
<h3 id="using-cloud-sql-with-a-jdbc-driver"><a class="anchor" href="#using-cloud-sql-with-a-jdbc-driver"></a>Using Cloud SQL with a JDBC driver</h3>
<div class="paragraph">
<p>To make your applications work with Cloud SQL, you first need to use the corresponding JDBC extension, for example, for PostgreSQL, add the <code>quarkus-jdbc-postgresql</code> extension.</p>
</div>
<div class="paragraph">
<p>Then you need to add to your <code>pom.xml</code> the Cloud SQL JDBC library that provides the additional connectivity to Cloud SQL. For PostgreSQL you will need to include the following dependency:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;com.google.cloud.sql&lt;/groupId&gt;
    &lt;artifactId&gt;postgres-socket-factory&lt;/artifactId&gt;
    &lt;version&gt;${postgres-socket-factory.version}&lt;/version&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, you need to configure your datasource specifically to use the socket factory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.datasource.db-kind=other <i class="conum" data-value="1"></i><b>(1)</b>
quarkus.datasource.jdbc.url=jdbc:postgresql:///mydatabase <i class="conum" data-value="2"></i><b>(2)</b>
quarkus.datasource.jdbc.driver=org.postgresql.Driver
quarkus.datasource.username=quarkus
quarkus.datasource.password=quarkus
quarkus.datasource.jdbc.additional-jdbc-properties.cloudSqlInstance=project-id:gcp-region:instance <i class="conum" data-value="3"></i><b>(3)</b>
quarkus.datasource.jdbc.additional-jdbc-properties.socketFactory=com.google.cloud.sql.postgres.SocketFactory <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Database kind must be 'other' as we need to skip Quarkus auto-configuration.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The JDBC URL should not include the hostname / IP of the database.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>We add the <code>cloudSqlInstance</code> additional JDBC property to configure the instance id.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>We add the <code>socketFactory</code> additional JDBC property to configure the socket factory used to connect to Cloud SQL, this one is coming from the <code>postgres-socket-factory</code> dependency.</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
If you use Hibernate ORM, you also need to configure <code>quarkus.hibernate-orm.dialect=org.hibernate.dialect.PostgreSQL10Dialect</code> as Hibernate ORM would not be able to automatically detect the dialect of your database.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Using a PostgreSQL socket factory is not possible in dev mode at the moment due to issue <a href="https://github.com/quarkusio/quarkus/issues/15782">#15782</a>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="リアクティブsqlクライアントでのcloud-sqlの使用"><a class="anchor" href="#リアクティブsqlクライアントでのcloud-sqlの使用"></a>リアクティブSQLクライアントでのCloud SQLの使用</h3>
<div class="paragraph">
<p>You can also use one of our reactive SQL client instead of the JDBC client. To do so with Cloud SQL, add the following dependency (adjust the classifier depending on your platform):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.netty&lt;/groupId&gt;
    &lt;artifactId&gt;netty-transport-native-epoll&lt;/artifactId&gt;
    &lt;classifier&gt;linux-x86_64&lt;/classifier&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>Then configure your reactive datasource with no hostname and with the Netty native transport:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.datasource.reactive.url=postgresql://:5432/db-name?host=/cloudsql/project-id:zone:db-name
quarkus.vertx.prefer-native-transport=true</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This only works when your application is running inside a Google Cloud managed runtime like App Engine.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="さらに詳しく"><a class="anchor" href="#さらに詳しく"></a>さらに詳しく</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can find a set of extensions to access various Google Cloud Services in the Quarkiverse (a GitHub organization for Quarkus extensions maintained by the community), including PubSub, BigQuery, Storage, Spanner, Firestore, Secret Manager (visit the repository for an accurate list of supported services).</p>
</div>
<div class="paragraph">
<p>これらについてのドキュメントは、 <a href="https://github.com/quarkiverse/quarkiverse-google-cloud-services">QuarkiverseのGoogle Cloud Servicesリポジトリ</a> にあります。</p>
</div>
</div>
</div>
    </div>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus はオープンです。このプロジェクトの全ての依存関係は<a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a>または互換性のあるライセンスの元で利用出来ます。<br /><br />このウェブサイトは <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a> で構築されており、<a href='https://pages.github.com/' target='_blank'>Github Pages</a>にホストされており、完全にオープンソースです。改善したい場合、 <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>ウェブサイトをフォークし</a>、修正してみせてください。</p>

    
      <div class="width-1-12 project-links">
        <span>ナビゲーション</span>
        <ul class="footer-links">
          
            <li><a href="/">ホーム</a></li>
          
            <li><a href="/about">Quarkusについて</a></li>
          
            <li><a href="/blog">ブログ</a></li>
          
            <li><a href="/insights">ポッドキャスト</a></li>
          
            <li><a href="/events">イベント</a></li>
          
            <li><a href="/newsletter">ニュースレター</a></li>
          
            <li><a href="/publications">出版</a></li>
          
            <li><a href="/awards">受賞</a></li>
          
            <li><a href="/security">セキュリティポリシー</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>フォロー</span>
        <ul class="footer-links">
          
            <li><a href="https://twitter.com/quarkusio">Twitter</a></li>
          
            <li><a href="https://www.facebook.com/quarkusio">Facebook</a></li>
          
            <li><a href="https://www.linkedin.com/company/quarkusio/">Linkedin</a></li>
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg">Youtube</a></li>
          
            <li><a href="https://github.com/quarkusio">GitHub</a></li>
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>ヘルプ</span>
        <ul class="footer-links">
          
            <li><a href="/support">サポート</a></li>
          
            <li><a href="/guides">ガイド</a></li>
          
            <li><a href="/faq">FAQ</a></li>
          
            <li><a href="/get-started">入門</a></li>
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus">Stack Overflow</a></li>
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions">ディスカッション</a></li>
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev">開発メーリングリスト</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Languages</span>
        <ul class="footer-links">
          
            <li><a href="https://quarkus.io/">English</a></li>
          
            <li><a href="https://ja.quarkus.io/">Japanese</a></li>
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkusはコミュニティプロジェクトで構成されています：</span>
        <ul class="footer-links">
          
            <li><a href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a href="https://code.quarkus.io/" target="_blank">等々...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/search-filter.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
</body>

</html>
