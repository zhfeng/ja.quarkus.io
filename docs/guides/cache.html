<!DOCTYPE html>
<html>





<head>
  <title>Quarkus - アプリケーションデータのキャッシング</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="Content-Security-Policy" content="default-src https://dpm.demdex.net; script-src 'self' 'unsafe-eval' 'sha256-ANpuoVzuSex6VhqpYgsG25OHWVA1I+F6aGU04LoI+5s=' 'sha256-ipy9P/3rZZW06mTLAR0EnXvxSNcnfSDPLDuh3kzbB1w=' js.bizographics.com https://www.redhat.com https://static.redhat.com assets.adobedtm.com jsonip.com https://ajax.googleapis.com https://www.googletagmanager.com https://www.google-analytics.com https://use.fontawesome.com https://app.mailjet.com http://www.youtube.com http://www.googleadservices.com https://googleads.g.doubleclick.net https://dpm.demdex.net https://giscus.app; style-src 'self' https://fonts.googleapis.com https://use.fontawesome.com; img-src 'self' *; media-src 'self'; frame-src https://www.googletagmanager.com https://www.youtube.com https://embed.restream.io https://app.mailjet.com https://giscus.app; base-uri 'none'; object-src 'none'; form-action 'none'; font-src 'self' https://use.fontawesome.com https://fonts.gstatic.com;" />
  <script id="adobe_dtm" src="https://www.redhat.com/dtm.js" type="text/javascript"></script>
  <script src="/assets/javascript/highlight.pack.js" type="text/javascript"></script>
  <META HTTP-EQUIV='X-XSS-Protection' CONTENT="1; mode=block">
  <META HTTP-EQUIV='X-Content-Type-Options' CONTENT="nosniff">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Quarkus: Supersonic Subatomic Java">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:site" content="@QuarkusIO"> 
  <meta name="twitter:creator" content="@QuarkusIO">
  <meta property="og:url" content="https://quarkus.io/guides/cache" />
  <meta property="og:title" content="アプリケーションデータのキャッシング" />
  <meta property="og:description" content="Quarkus: Supersonic Subatomic Java" />
  <meta property="og:image" content="https://quarkus.io/assets/images/quarkus_card.png" />
  
  <link rel="canonical" href="https://quarkus.io/guides/cache">
  <link rel="shortcut icon" type="image/png" href="/favicon.ico" >
  <link rel="stylesheet" href="/guides/stylesheet/config.css" />
  <link rel="stylesheet" href="/assets/css/main.css?2021-07-29" />
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
  <link rel="alternate" type="application/rss+xml"  href="/feed.xml" title="Quarkus">
  <script src="/assets/javascript/goan.js" type="text/javascript"></script>
  <script src="/assets/javascript/hl.js" type="text/javascript"></script>
</head>

<body class="guides">
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NJWS5L"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

  <div class="nav-wrapper">
  <div class="grid-wrapper">
    <div class="width-12-12">
      <input type="checkbox" id="checkbox" />
      <nav id="main-nav" class="main-nav">
  <div class="container">
    <div class="logo-wrapper">
        <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_600px_reverse.png" class="project-logo" title="Quarkus"></a>
    </div>
    <label class="nav-toggle" for="checkbox"> <i class="fa fa-bars"></i>
</label>
    <ul id="menu" class="menu">
      <li class="dropdown">
        <span href="/about/">Quarkusとは <i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/about" class="">QUARKUSとは何か?</a></li>
          <li><a href="/container-first" class="">コンテナ・ファースト</a></li>
          <li><a href="/continuum" class="">リアクティブ</a></li>
          <li><a href="/developer-joy" class="">開発者満足</a></li>
          <li><a href="/kubernetes-native" class="">KUBERNETES NATIVE</a></li>
          <li><a href="/standards" class="">標準</a></li>
        </ul>
      </li>
      <li class="dropdown">
        <span href="/learn/">学ぶ<i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/get-started" class="">入門</a></li>
          <li><a href="/guides" class="active">ガイド</a></li>
          <li><a href="/qtips" class="">"Q" Tipsビデオ</a></li>          
          <li><a href="/books" class="">書籍</a></li>
          </ul>
      </li>
      <li class="dropdown">
        <span href="/community/">コミュニティ <i class="fas
fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="/support/" class="">サポート</a></li>
          <li><a href="/blog" class="">ブログ</a></li>
          <li><a href="/discussion" class="">ディスカッション</a></li>
          <li><a href="/insights" class="">ポッドキャスト</a></li>
          <li><a href="/events" class="">イベント</a></li>
          <li><a href="/newsletter" class="">ニュースレター</a></li>
          <li><a href="/publications" class="">出版物</a></li>
          <li><a href="/awards" class="">受賞</a></li>
          </ul>
      </li>
      <li>
        <a href="https://code.quarkus.io" class="button-cta secondary
white">コーディングを開始</a>
      </li>
      <li class="dropdown">
        <span href="/language/"><div class="fas fa-globe langicon"></div><i class="fas fa-chevron-down"></i></span>
        <ul class="submenu">
          <li><a href="https://quarkus.io/" >ENGLISH</a></li>
          <li><a href="https://ja.quarkus.io/">JAPANESE</a></li>
          </ul>
      </li>
    </ul>
  </div>
      </nav>
    </div>
  </div>
</div>

  <div class="content">
    



<div class="full-width-version-bg grey align-self">
  <div class="grid-wrapper">
    <div class="grid__item width-6-12">
      <p class="returnlink"><i class="fas fa-angle-left"></i><a href="/guides/"> Back to Guides</a></p>
    </div>
    <div class="grid__item width-6-12 align-self-center text-right hide-mobile">
      <label id="guide-version-label">Select Guide Version</label>
      <select id="guide-version-dropdown">
        
      
        
        
        
        
          
        <option value="main" >Main - SNAPSHOT</option>
        
        
      
        
        
        
        
          
        <option value="latest" selected>2.9 - Latest</option>
        
        
      
        
        
        
        
          
        <option value="2.7" >2.7</option>
        
        
      
        
        
        
        
          
        <option value="2.2" >2.2</option>
        
        
      
        
        
        
        
          
        <option value="1.11" >1.11</option>
        
        
      
    
      </select>
    </div>
  </div>
</div>

<div class="grid-wrapper guide">
  <div class="grid__item width-12-12 width-12-12-mobile">
    <h1 class="text-caps">アプリケーションデータのキャッシング </h1>
  </div>
  <div class="width-12-12">
    <div class="hide-mobile toc"><ul class="sectlevel1">
<li><a href="#前提条件">前提条件</a></li>
<li><a href="#シナリオ">シナリオ</a></li>
<li><a href="#ソリューション">ソリューション</a></li>
<li><a href="#mavenプロジェクトの作成">Mavenプロジェクトの作成</a></li>
<li><a href="#rest-apiの作成">REST APIの作成</a></li>
<li><a href="#キャッシュの有効化">キャッシュの有効化</a></li>
<li><a href="#annotations-api">Caching using annotations</a>
<ul class="sectlevel2">
<li><a href="#cacheresult">@CacheResult</a></li>
<li><a href="#cacheinvalidate">@CacheInvalidate</a></li>
<li><a href="#cacheinvalidateall">@CacheInvalidateAll</a></li>
<li><a href="#cachekey">@CacheKey</a></li>
<li><a href="#複合キャッシュキー構築ロジック">複合キャッシュキー構築ロジック</a></li>
</ul>
</li>
<li><a href="#programmatic-api">Caching using the programmatic API</a>
<ul class="sectlevel2">
<li><a href="#injecting-a-cache-with-the-cachename-annotation">Injecting a <code>Cache</code> with the <code>@CacheName</code> annotation</a></li>
<li><a href="#retrieving-a-cache-from-the-cachemanager">Retrieving a <code>Cache</code> from the <code>CacheManager</code></a></li>
<li><a href="#building-a-programmatic-cache-key">Building a programmatic cache key</a></li>
<li><a href="#retrieving-all-keys-from-a-caffeinecache">Retrieving all keys from a <code>CaffeineCache</code></a></li>
</ul>
</li>
<li><a href="#基礎となるキャッシングプロバイダーの設定">基礎となるキャッシングプロバイダーの設定</a>
<ul class="sectlevel2">
<li><a href="#caffeine設定プロパティ">Caffeine設定プロパティ</a></li>
</ul>
</li>
<li><a href="#enabling-micrometer-metrics">Enabling Micrometer metrics</a></li>
<li><a href="#注釈付きbean例">注釈付きBean例</a>
<ul class="sectlevel2">
<li><a href="#暗黙の単純キャッシュキー">暗黙の単純キャッシュキー</a></li>
<li><a href="#明示的な合成キャッシュキー">明示的な合成キャッシュキー</a></li>
<li><a href="#デフォルトのキャッシュキー">デフォルトのキャッシュキー</a></li>
<li><a href="#単一のメソッドに複数のアノテーションを付与">単一のメソッドに複数のアノテーションを付与</a></li>
<li><a href="#clear-all-application-caches">Clear all application caches</a></li>
</ul>
</li>
<li><a href="#negative-cache">ネガティブキャッシングとnull</a>
<ul class="sectlevel2">
<li><a href="#例外をバブルアップさせる">例外をバブルアップさせる</a></li>
</ul>
</li>
<li><a href="#ネイティブ化">ネイティブ化</a></li>
</ul></div>
    <div>
      <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>このガイドでは、QuarkusアプリケーションのCDI管理されたBeanでアプリケーションデータのキャッシングを有効にする方法について説明します。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>この技術は、previewと考えられています。</p>
</div>
<div class="paragraph">
<p><em>preview</em> では、下位互換性やエコシステムでの存在は保証されていません。具体的な改善には設定や API の変更が必要になるかもしれませんが、 <em>stable</em> になるための計画は現在進行中です。フィードバックは <a href="https://groups.google.com/d/forum/quarkus-dev">メーリングリスト</a> や <a href="https://github.com/quarkusio/quarkus/issues">GitHub の課題管理</a> で受け付けています。</p>
</div>
<div class="paragraph">
<p>とりうるステータスの完全なリストについては、 <a href="https://quarkus.io/faq/#extension-status">FAQの項目</a> を参照してください。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="前提条件"><a class="anchor" href="#前提条件"></a>前提条件</h2>
<div class="sectionbody">
<div class="paragraph">
<p>このガイドを完成させるには、以下が必要です:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>約15分</p>
</li>
<li>
<p>IDE</p>
</li>
<li>
<p>JDK 11+ がインストールされ、 <code>JAVA_HOME</code> が適切に設定されていること</p>
</li>
<li>
<p>Apache Maven 3.8.1+</p>
</li>
<li>
<p>使用したい場合、 <a href="cli-tooling.html">Quarkus CLI</a></p>
</li>
<li>
<p>ネイティブ実行可能ファイルをビルドしたい場合、MandrelまたはGraalVM（あるいはネイティブなコンテナビルドを使用する場合はDocker）をインストールし、 <a href="building-native-image.html#configuring-graalvm">適切に設定</a>していること</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="シナリオ"><a class="anchor" href="#シナリオ"></a>シナリオ</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkusアプリケーションで、ユーザーが今後3日間の天気予報を取得できるREST APIを公開したいとします。問題は、一度に1日分のリクエストしか受け付けず、応答に時間がかかる外部の気象サービスに依存しなければならないことです。天気予報は12時間に一度更新されるので、サービスのレスポンスをキャッシュすればAPIのパフォーマンスは間違いなく向上します。</p>
</div>
<div class="paragraph">
<p>これをQuarkusの単一のアノテーションを使用して行います。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ソリューション"><a class="anchor" href="#ソリューション"></a>ソリューション</h2>
<div class="sectionbody">
<div class="paragraph">
<p>次のセクションで紹介する手順に沿って、ステップを踏んでアプリを作成することをお勧めします。ただし、完成した例にそのまま進んでも構いません。</p>
</div>
<div class="paragraph">
<p>Gitレポジトリをクローンするか <code>git clone <a href="https://github.com/quarkusio/quarkus-quickstarts.git" class="bare">https://github.com/quarkusio/quarkus-quickstarts.git</a></code> 、 <a href="https://github.com/quarkusio/quarkus-quickstarts/archive/main.zip">アーカイブ</a> をダウンロードします。</p>
</div>
<div class="paragraph">
<p>ソリューションは <code>cache-quickstart</code> <a href="https://github.com/quarkusio/quarkus-quickstarts/tree/main/cache-quickstart">ディレクトリ</a> にあります。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="mavenプロジェクトの作成"><a class="anchor" href="#mavenプロジェクトの作成"></a>Mavenプロジェクトの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>まず、以下のコマンドで新しいQuarkusプロジェクトを作成します。</p>
</div>
<div class="sidebarblock primary asciidoc-tabs-sync-cli">
<div class="content">
<div class="title">CLI</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus create app org.acme:cache-quickstart \
    --extension=cache,resteasy-reactive-jackson \
    --no-code
cd cache-quickstart</code></pre>
</div>
</div>
<div class="paragraph">
<p>To create a Gradle project, add the <code>--gradle</code> or <code>--gradle-kotlin-dsl</code> option.</p>
</div>
<div class="paragraph">
<p><em>For more information about how to install the Quarkus CLI and use it, please refer to <a href="cli-tooling">the Quarkus CLI guide</a>.</em></p>
</div>
</div>
</div>
<div class="sidebarblock secondary asciidoc-tabs-sync-maven">
<div class="content">
<div class="title">Maven</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mvn io.quarkus.platform:quarkus-maven-plugin:2.9.0.Final:create \
    -DprojectGroupId=org.acme \
    -DprojectArtifactId=cache-quickstart \
    -Dextensions="cache,resteasy-reactive-jackson" \
    -DnoCode
cd cache-quickstart</code></pre>
</div>
</div>
<div class="paragraph">
<p>To create a Gradle project, add the <code>-DbuildTool=gradle</code> or <code>-DbuildTool=gradle-kotlin-dsl</code> option.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>This command generates the project and imports the <code>cache</code> and <code>resteasy-reactive-jackson</code> extensions.</p>
</div>
<div class="paragraph">
<p>すでにQuarkusプロジェクトが設定されている場合は、プロジェクトのベースディレクトリーで以下のコマンドを実行することで、プロジェクトに <code>cache</code> エクステンションを追加することができます。</p>
</div>
<div class="listingblock primary,  asciidoc-tabs-sync-cli">
<div class="title">CLI</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus extension add 'cache'</code></pre>
</div>
</div>
<div class="listingblock secondary,  asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw quarkus:add-extension -Dextensions="cache"</code></pre>
</div>
</div>
<div class="listingblock secondary,  asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew addExtension --extensions="cache"</code></pre>
</div>
</div>
<div class="paragraph">
<p>これにより、 <code>pom.xml</code> に以下が追加されます:</p>
</div>
<div class="listingblock primary asciidoc-tabs-target-sync-cli asciidoc-tabs-target-sync-maven">
<div class="title">pom.xml</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;dependency&gt;
    &lt;groupId&gt;io.quarkus&lt;/groupId&gt;
    &lt;artifactId&gt;quarkus-cache&lt;/artifactId&gt;
&lt;/dependency&gt;</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-target-sync-gradle">
<div class="title">build.gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-gradle hljs" data-lang="gradle">implementation("io.quarkus:quarkus-cache")</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="rest-apiの作成"><a class="anchor" href="#rest-apiの作成"></a>REST APIの作成</h2>
<div class="sectionbody">
<div class="paragraph">
<p>まずは、外部気象サービスへの非常に遅い呼び出しをシミュレートするサービスを作成してみましょう。以下の内容で <code>src/main/java/org/acme/cache/WeatherForecastService.java</code> を作成します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.cache;

import java.time.LocalDate;

import javax.enterprise.context.ApplicationScoped;

@ApplicationScoped
public class WeatherForecastService {

    public String getDailyForecast(LocalDate date, String city) {
        try {
            Thread.sleep(2000L); <i class="conum" data-value="1"></i><b>(1)</b>
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
        return date.getDayOfWeek() + " will be " + getDailyResult(date.getDayOfMonth() % 4) + " in " + city;
    }

    private String getDailyResult(int dayOfMonthModuloFour) {
        switch (dayOfMonthModuloFour) {
            case 0:
                return "sunny";
            case 1:
                return "cloudy";
            case 2:
                return "chilly";
            case 3:
                return "rainy";
            default:
                throw new IllegalArgumentException();
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>遅さはここに由来します。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>また、ユーザーが次の3日間の天気予報を求めたときに送信されるレスポンスを含むクラスも必要です。 <code>src/main/java/org/acme/cache/WeatherForecast.java</code> をこのように作成します:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.cache;

import java.util.List;

public class WeatherForecast {

    private List&lt;String&gt; dailyForecasts;

    private long executionTimeInMs;

    public WeatherForecast(List&lt;String&gt; dailyForecasts, long executionTimeInMs) {
        this.dailyForecasts = dailyForecasts;
        this.executionTimeInMs = executionTimeInMs;
    }

    public List&lt;String&gt; getDailyForecasts() {
        return dailyForecasts;
    }

    public long getExecutionTimeInMs() {
        return executionTimeInMs;
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now, we just need to create the REST resource. Create the <code>src/main/java/org/acme/cache/WeatherForecastResource.java</code> file with this content:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.cache;

import java.time.LocalDate;
import java.util.Arrays;
import java.util.List;

import javax.inject.Inject;
import javax.ws.rs.GET;
import javax.ws.rs.Path;
import javax.ws.rs.core.MediaType;

import org.jboss.resteasy.reactive.RestQuery;

@Path("/weather")
public class WeatherForecastResource {

    @Inject
    WeatherForecastService service;

    @GET
    public WeatherForecast getForecast(@RestQuery String city, @RestQuery long daysInFuture) { <i class="conum" data-value="1"></i><b>(1)</b>
        long executionStart = System.currentTimeMillis();
        List&lt;String&gt; dailyForecasts = Arrays.asList(
                service.getDailyForecast(LocalDate.now().plusDays(daysInFuture), city),
                service.getDailyForecast(LocalDate.now().plusDays(daysInFuture + 1L), city),
                service.getDailyForecast(LocalDate.now().plusDays(daysInFuture + 2L), city));
        long executionEnd = System.currentTimeMillis();
        return new WeatherForecast(dailyForecasts, executionEnd - executionStart);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>daysInFuture</code> クエリパラメーターが省略された場合、3 日間の天気予報は現在の日から始まります。それ以外の場合は、現在の日に <code>daysInFuture</code> の値を加えたものから始まります。</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>完了です!うまくいっているか確認してみましょう</p>
</div>
<div class="paragraph">
<p>First, run the application using dev mode from the project directory:</p>
</div>
<div class="listingblock primary asciidoc-tabs-sync-cli">
<div class="title">CLI</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">quarkus dev</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-maven">
<div class="title">Maven</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./mvnw quarkus:dev</code></pre>
</div>
</div>
<div class="listingblock secondary asciidoc-tabs-sync-gradle">
<div class="title">Gradle</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">./gradlew --console=plain quarkusDev</code></pre>
</div>
</div>
<div class="paragraph">
<p>次に、 <code><a href="http://localhost:8080/weather?city=Raleigh" class="bare">http://localhost:8080/weather?city=Raleigh</a></code> ブラウザからを呼び出します。6秒ほど長い時間が経過すると、アプリケーションは次のような回答をします。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-json hljs" data-lang="json">{"dailyForecasts":["MONDAY will be cloudy in Raleigh","TUESDAY will be chilly in Raleigh","WEDNESDAY will be rainy in Raleigh"],"executionTimeInMs":6001}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>コードを実行する日によってレスポンスの内容が異なる場合があります。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>何度も同じURLに電話をかけてみても、必ず6秒でレスポンスが返却されます。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="キャッシュの有効化"><a class="anchor" href="#キャッシュの有効化"></a>キャッシュの有効化</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkusアプリケーションが動いたので、外部の気象サービスのレスポンスをキャッシュすることで、レスポンスタイムを大幅に改善してみましょう。 <code>WeatherForecastService</code> クラスを次のように修正します。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.cache;

import java.time.LocalDate;

import javax.enterprise.context.ApplicationScoped;

import io.quarkus.cache.CacheResult;

@ApplicationScoped
public class WeatherForecastService {

    @CacheResult(cacheName = "weather-cache") <i class="conum" data-value="1"></i><b>(1)</b>
    public String getDailyForecast(LocalDate date, String city) {
        try {
            Thread.sleep(2000L);
        } catch (InterruptedException e) {
            Thread.currentThread().interrupt();
        }
        return date.getDayOfWeek() + " will be " + getDailyResult(date.getDayOfMonth() % 4) + " in " + city;
    }

    private String getDailyResult(int dayOfMonthModuloFour) {
        switch (dayOfMonthModuloFour) {
            case 0:
                return "sunny";
            case 1:
                return "cloudy";
            case 2:
                return "chilly";
            case 3:
                return "rainy";
            default:
                throw new IllegalArgumentException();
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>このアノテーション(もちろん関連するインポートも)を追加しただけです。
<div class="literalblock">
<div class="content">
<pre>`http://localhost:8080/weather?city=Raleigh` をもう一度実行してみましょう。レスポンスが来るまでにまだ長い時間待たされています。これはサーバーが再起動したばかりでキャッシュが空になっているので正常です。</pre>
</div>
</div></td>
</tr>
</table>
</div>
<div class="paragraph">
<p>ちょっと待って!? <code>WeatherForecastService</code> のアップデート後、サーバーが勝手に再起動した?はい、これは、 <code>live coding</code> と呼ばれる開発者のためのQuarkusの驚くべき機能の一つです。</p>
</div>
<div class="paragraph">
<p>前回の呼び出しでキャッシュが読み込まれたので、同じ URL を呼び出してみてください。今度は、 <code>executionTimeInMs</code> の値が 0 に近い超高速な応答が返ってくるはずです。</p>
</div>
<div class="paragraph">
<p><code><a href="http://localhost:8080/weather?city=Raleigh&amp;daysInFuture=1" class="bare">http://localhost:8080/weather?city=Raleigh&amp;daysInFuture=1</a></code> のURLで、未来のある日から始めるとどうなるか見てみましょう。要求された日のうち2つはすでにキャッシュに読み込まれていたので、2秒後に回答が得られるはずです。</p>
</div>
<div class="paragraph">
<p>また、同じURLを別の都市で呼び出してみて、再度キャッシュの動作を確認することもできます。最初の呼出には6秒ほどかかり、次の呼出にはすぐに出ます。</p>
</div>
<div class="paragraph">
<p>おめでとうございます。たった1行のコードでQuarkusアプリケーションにアプリケーションデータのキャッシングを追加しました。</p>
</div>
<div class="paragraph">
<p>Quarkusアプリケーションのデータキャッシング機能について詳しく知りたいですか?以下のセクションでは、この機能について知っておくべきことをすべて紹介します。</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="annotations-api"><a class="anchor" href="#annotations-api"></a>Caching using annotations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkusは、CDI管理されたBeanで使用できる、キャッシング機能を有効にするアノテーションのセットを提供します。</p>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>プライベートメソッドではキャッシュのアノテーションは許可されていません。package-private (明示的な修飾子を持たない) を含む他のアクセス修飾子では問題なく動作します。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="cacheresult"><a class="anchor" href="#cacheresult"></a>@CacheResult</h3>
<div class="paragraph">
<p>可能な限り、メソッド本体を実行せずにキャッシュからメソッドの結果を読み込みます。</p>
</div>
<div class="paragraph">
<p><code>@CacheResult</code> でアノテーションされたメソッドが呼び出されると、Quarkusはキャッシュキーを計算し、それを使用して、そのメソッドがすでに呼び出されているかどうかをキャッシュでチェックします。メソッドに1つ以上の引数がある場合、キーの計算は、 <code>@CacheKey</code> でアノテーションされていない場合はすべてのメソッド引数から、そうでない場合は <code>@CacheKey</code> でアノテーションされているすべての引数から行われます。キャッシュが期待通りに動作するためには、キーの一部である非プリミティブなメソッドの各引数は <code>equals()</code> と <code>hashCode()</code> を正しく実装しなければなりません。このアノテーションは引数を持たないメソッドにも使用することができ、その場合はキャッシュ名から派生したデフォルトキーが使用されます。キャッシュ内に値が見つかった場合はそれが返され、アノテーションされたメソッドは実際には実行されません。値が見つからない場合は、アノテーションされたメソッドが呼び出され、返された値は計算されたキーを使用してキャッシュに保存されます。</p>
</div>
<div class="paragraph">
<p><code>CacheResult</code> でアノテーションされたメソッドは、キャッシュミスのロック機構によって保護されています。複数の同時呼び出しが同じ欠落キーからキャッシュ値を取得しようとした場合、メソッドは一度だけ呼び出されます。最初の同時呼び出しはメソッドの呼び出しをトリガし、その後の同時呼び出しはキャッシュされた結果を取得するためにメソッドの呼び出しの終了を待ちます。 <code>lockTimeout</code> パラメーターを使用すると、所定の遅延後にロックを中断することができます。ロックのタイムアウトは既定では無効になっており、ロックが中断されることはありません。詳細は、パラメーター Javadoc を参照してください。</p>
</div>
<div class="paragraph">
<p>このアノテーションは、 <code>void</code> を返すメソッドでは使用できません。</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Quarkusは、基礎となるCaffeineプロバイダとは異なり、 <code>null</code> の値をキャッシュすることもできます。 <a href="#negative-cache">このトピックの詳細は以下</a> を参照してください。</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="cacheinvalidate"><a class="anchor" href="#cacheinvalidate"></a>@CacheInvalidate</h3>
<div class="paragraph">
<p>キャッシュからエントリーを削除します。</p>
</div>
<div class="paragraph">
<p><code>@CacheInvalidate</code> でアノテーションされたメソッドが呼び出されると、Quarkusはキャッシュキーを計算し、それを使用してキャッシュから既存のエントリーを削除しようとします。メソッドに1つ以上の引数がある場合、キーの計算は、 <code>@CacheKey</code> でアノテーションされていない場合はすべてのメソッド引数から、そうでない場合は <code>@CacheKey</code> でアノテーションされているすべての引数から行われます。このアノテーションは引数を持たないメソッドでも使用でき、その場合はキャッシュ名から派生したデフォルトのキーが使用されます。キーがキャッシュエントリーを識別しない場合は、何も起こりません。</p>
</div>
</div>
<div class="sect2">
<h3 id="cacheinvalidateall"><a class="anchor" href="#cacheinvalidateall"></a>@CacheInvalidateAll</h3>
<div class="paragraph">
<p><code>@CacheInvalidateAll</code> でアノテーションされたメソッドが呼び出されると、Quarkusはキャッシュからすべてのエントリーを削除します。</p>
</div>
</div>
<div class="sect2">
<h3 id="cachekey"><a class="anchor" href="#cachekey"></a>@CacheKey</h3>
<div class="paragraph">
<p>メソッドの引数が <code>@CacheKey</code> でアノテーションされている場合、 <code>@CacheResult</code> または <code>@CacheInvalidate</code> でアノテーションされたメソッドの呼び出し時にキャッシュキーの一部として識別されます。</p>
</div>
<div class="paragraph">
<p>このアノテーションはオプションで、メソッドの引数の一部がキャッシュキーの一部ではない場合にのみ使用されるべきです。</p>
</div>
</div>
<div class="sect2">
<h3 id="複合キャッシュキー構築ロジック"><a class="anchor" href="#複合キャッシュキー構築ロジック"></a>複合キャッシュキー構築ロジック</h3>
<div class="paragraph">
<p>キャッシュキーが複数のメソッド引数から構築される場合、それらが明示的に <code>@CacheKey</code> で識別されているかどうかに関わらず、構築ロジックはメソッドシグネチャ内のこれらの引数の順序に依存します。一方、引数名は全く使用されず、キャッシュキーには何の影響も与えません。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.cache;

import javax.enterprise.context.ApplicationScoped;

import io.quarkus.cache.CacheInvalidate;
import io.quarkus.cache.CacheResult;

@ApplicationScoped
public class CachedService {

    @CacheResult(cacheName = "foo")
    public Object load(String keyElement1, Integer keyElement2) {
        // Call expensive service here.
    }

    @CacheInvalidate(cacheName = "foo")
    public void invalidate1(String keyElement2, Integer keyElement1) { <i class="conum" data-value="1"></i><b>(1)</b>
    }

    @CacheInvalidate(cacheName = "foo")
    public void invalidate2(Integer keyElement2, String keyElement1) { <i class="conum" data-value="2"></i><b>(2)</b>
    }

    @CacheInvalidate(cacheName = "foo")
    public void invalidate3(Object notPartOfTheKey, @CacheKey String keyElement1, @CacheKey Integer keyElement2) { <i class="conum" data-value="3"></i><b>(3)</b>
    }

    @CacheInvalidate(cacheName = "foo")
    public void invalidate4(Object notPartOfTheKey, @CacheKey Integer keyElement2, @CacheKey String keyElement1) { <i class="conum" data-value="4"></i><b>(4)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>このメソッドを呼び出すと、キー要素名が入れ替わっていても <code>load</code> メソッドでキャッシュされた値が無効になります。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>このメソッドを呼び出すと、キー要素の順序が異なるため、 <code>load</code> メソッドでキャッシュされた値が無効になることはありません。</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>このメソッドを呼び出すと、キー要素の順序が同じなので、 <code>load</code> メソッドでキャッシュされた値が無効になります。</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>このメソッドを呼び出すと、キー要素の順序が異なるため、 <code>load</code> メソッドでキャッシュされた値が無効になることはありません。</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="programmatic-api"><a class="anchor" href="#programmatic-api"></a>Caching using the programmatic API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Quarkus also offers a programmatic API which can be used to store, retrieve or delete values from any cache declared using the annotations API. All operations from the programmatic API are non-blocking and rely on <a href="https://smallrye.io/smallrye-mutiny/">Mutiny</a> under the hood.</p>
</div>
<div class="paragraph">
<p>Before accessing programmatically the cached data, you need to retrieve an <code>io.quarkus.cache.Cache</code> instance. The following sections will show you how to do that.</p>
</div>
<div class="sect2">
<h3 id="injecting-a-cache-with-the-cachename-annotation"><a class="anchor" href="#injecting-a-cache-with-the-cachename-annotation"></a>Injecting a <code>Cache</code> with the <code>@CacheName</code> annotation</h3>
<div class="paragraph">
<p><code>io.quarkus.cache.CacheName</code> can be used on a field, a constructor parameter or a method parameter to inject a <code>Cache</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.cache;

import javax.enterprise.context.ApplicationScoped;
import javax.inject.Inject;

import io.quarkus.cache.Cache;
import io.quarkus.cache.CacheName;
import io.smallrye.mutiny.Uni;

@ApplicationScoped
public class CachedExpensiveService {

    @Inject <i class="conum" data-value="1"></i><b>(1)</b>
    @CacheName("my-cache")
    Cache cache;

    public Uni&lt;String&gt; getNonBlockingExpensiveValue(Object key) { <i class="conum" data-value="2"></i><b>(2)</b>
        return cache.get(key, k -&gt; { <i class="conum" data-value="3"></i><b>(3)</b>
            /*
             * Put an expensive call here.
             * It will be executed only if the key is not already associated with a value in the cache.
             */
        });
    }

    public String getBlockingExpensiveValue(Object key) {
        return cache.get(key, k -&gt; {
            // Put an expensive call here.
        }).await().indefinitely(); <i class="conum" data-value="4"></i><b>(4)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>This is optional.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This method returns the <code>Uni&lt;String&gt;</code> type which is non-blocking.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The <code>k</code> argument contains the cache key value.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>If you don&#8217;t need the call to be non-blocking, this is how you can retrieve the cache value in a blocking way.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="retrieving-a-cache-from-the-cachemanager"><a class="anchor" href="#retrieving-a-cache-from-the-cachemanager"></a>Retrieving a <code>Cache</code> from the <code>CacheManager</code></h3>
<div class="paragraph">
<p>Another way to retrieve a <code>Cache</code> instance consists in injecting the <code>io.quarkus.cache.CacheManager</code> first and then retrieving the desired <code>Cache</code> from its name:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.cache;

import javax.enterprise.context.ApplicationScoped;
import javax.inject.Inject;

import io.quarkus.cache.Cache;
import io.quarkus.cache.CacheManager;

import java.util.Optional;

@ApplicationScoped
public class CacheClearer {

    @Inject
    CacheManager cacheManager;

    public void clearCache(String cacheName) {
        Optional&lt;Cache&gt; cache = cacheManager.getCache(cacheName);
        if (cache.isPresent()) {
            cache.get().invalidateAll().await().indefinitely();
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="building-a-programmatic-cache-key"><a class="anchor" href="#building-a-programmatic-cache-key"></a>Building a programmatic cache key</h3>
<div class="paragraph">
<p>Before building a programmatic cache key, you need to know how cache keys are built by the annotations API when an annotated method is invoked:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>If the method has no arguments, then the cache key is an instance of <code>io.quarkus.cache.DefaultCacheKey</code> built from the cache name.</p>
</li>
<li>
<p>If the method has exactly one argument, then this argument is the cache key.</p>
</li>
<li>
<p>If the method has multiple arguments but only one annotated with <code>@CacheKey</code>, then this annotated argument is the cache key.</p>
</li>
<li>
<p>In all other cases, the cache key is an instance of <code>io.quarkus.cache.CompositeCacheKey</code> built from multiple method arguments (annotated with <code>@CacheKey</code> or not).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now, if you want to retrieve or delete, using the programmatic API, a cache value that was stored using the annotations API, you just need to make sure the same key is used with both APIs.</p>
</div>
</div>
<div class="sect2">
<h3 id="retrieving-all-keys-from-a-caffeinecache"><a class="anchor" href="#retrieving-all-keys-from-a-caffeinecache"></a>Retrieving all keys from a <code>CaffeineCache</code></h3>
<div class="paragraph">
<p>The cache keys from a specific <code>CaffeineCache</code> can be retrieved as an unmodifiable <code>Set</code> as shown below. If the cache entries are modified while an iteration over the set is in progress, the set will remain unchanged.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.cache;

import javax.enterprise.context.ApplicationScoped;

import io.quarkus.cache.Cache;
import io.quarkus.cache.CacheName;
import io.quarkus.cache.CaffeineCache;

import java.util.Set;

@ApplicationScoped
public class CacheKeysService {

    @CacheName("my-cache")
    Cache cache;

    public Set&lt;Object&gt; getAllCacheKeys() {
        return cache.as(CaffeineCache.class).keySet();
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="基礎となるキャッシングプロバイダーの設定"><a class="anchor" href="#基礎となるキャッシングプロバイダーの設定"></a>基礎となるキャッシングプロバイダーの設定</h2>
<div class="sectionbody">
<div class="paragraph">
<p>このエクステンションは、基礎となるキャッシュプロバイダとして <a href="https://github.com/ben-manes/caffeine">Caffeine</a> を使用しています。Caffeine は高性能で最適に近いキャッシングライブラリです。</p>
</div>
<div class="sect2">
<h3 id="caffeine設定プロパティ"><a class="anchor" href="#caffeine設定プロパティ"></a>Caffeine設定プロパティ</h3>
<div class="paragraph">
<p>Quarkusアプリケーションのデータキャッシュエクステンションを支える各Caffeineキャッシュは、 <code>application.properties</code> ファイルの以下のプロパティーを使用して設定することができます。デフォルトでは、設定されていない場合、キャッシュはどのようなタイプの退避も実行しません。</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>以下のすべてのプロパティーで <code>cache-name</code> を設定したいキャッシュの実名に置き換える必要があります。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph configuration-legend">
<p><span class="icon"><i class="fa fa-lock" title="ビルド時に固定"></i></span> ビルド時に固定される設定プロパティ - それ以外の設定プロパティは実行時に上書き可能</p>
</div>
<table class="tableblock frame-all grid-all stretch configuration-reference">
<colgroup>
<col style="width: 80%;">
<col style="width: 10%;">
<col style="width: 10%;">
</colgroup>
<tbody>
<tr>
<th class="tableblock halign-left valign-top"><p class="tableblock"><a id="quarkus-cache-config-group-cache-config-caffeine-config_configuration"></a><a href="#quarkus-cache-config-group-cache-config-caffeine-config_configuration">Configuration property</a></p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">タイプ</p></th>
<th class="tableblock halign-left valign-middle"><p class="tableblock">デフォルト</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-cache-config-group-cache-config-caffeine-config_quarkus.cache.caffeine.-cache-name-.initial-capacity"></a><code><a href="#quarkus-cache-config-group-cache-config-caffeine-config_quarkus.cache.caffeine.-cache-name-.initial-capacity">quarkus.cache.caffeine."cache-name".initial-capacity</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Minimum total size for the internal data structures. Providing a large enough estimate at construction time avoids the need for expensive resizing operations later, but setting this value unnecessarily high wastes memory.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">int</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-cache-config-group-cache-config-caffeine-config_quarkus.cache.caffeine.-cache-name-.maximum-size"></a><code><a href="#quarkus-cache-config-group-cache-config-caffeine-config_quarkus.cache.caffeine.-cache-name-.maximum-size">quarkus.cache.caffeine."cache-name".maximum-size</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Maximum number of entries the cache may contain. Note that the cache <strong>may evict an entry before this limit is exceeded or temporarily exceed the threshold while evicting</strong>. As the cache size grows close to the maximum, the cache evicts entries that are less likely to be used again. For example, the cache may evict an entry because it hasn&#8217;t been used recently or very often.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">long</p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-cache-config-group-cache-config-caffeine-config_quarkus.cache.caffeine.-cache-name-.expire-after-write"></a><code><a href="#quarkus-cache-config-group-cache-config-caffeine-config_quarkus.cache.caffeine.-cache-name-.expire-after-write">quarkus.cache.caffeine."cache-name".expire-after-write</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Specifies that each entry should be automatically removed from the cache once a fixed duration has elapsed after the entry&#8217;s creation, or the most recent replacement of its value.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><a href="https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html">Duration</a>
  <a href="#duration-note-anchor" title="More information about the Duration format"><span class="icon"><i class="fa fa-question-circle"></i></span></a></p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-cache-config-group-cache-config-caffeine-config_quarkus.cache.caffeine.-cache-name-.expire-after-access"></a><code><a href="#quarkus-cache-config-group-cache-config-caffeine-config_quarkus.cache.caffeine.-cache-name-.expire-after-access">quarkus.cache.caffeine."cache-name".expire-after-access</a></code></p>
</div>
<div class="openblock description">
<div class="content">
<div class="paragraph">
<p>Specifies that each entry should be automatically removed from the cache once a fixed duration has elapsed after the entry&#8217;s creation, the most recent replacement of its value, or its last read.</p>
</div>
</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><a href="https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html">Duration</a>
  <a href="#duration-note-anchor" title="More information about the Duration format"><span class="icon"><i class="fa fa-question-circle"></i></span></a></p></td>
<td class="tableblock halign-left valign-middle"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><span class="icon"><i class="fa fa-lock" title="Fixed at build time"></i></span> <a id="quarkus-cache-config-group-cache-config-caffeine-config_quarkus.cache.caffeine.-cache-name-.metrics-enabled"></a><code><a href="#quarkus-cache-config-group-cache-config-caffeine-config_quarkus.cache.caffeine.-cache-name-.metrics-enabled">quarkus.cache.caffeine."cache-name".metrics-enabled</a></code></p>
</div>
<div class="openblock description">
<div class="content">

</div>
</div></div></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock">boolean</p></td>
<td class="tableblock halign-left valign-middle"><p class="tableblock"><code>false</code></p></td>
</tr>
</tbody>
</table>
<div id="duration-note-anchor" class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title">期間フォーマットについて</div>
<div class="paragraph">
<p>期間のフォーマットは標準の <code>java.time.Duration</code> フォーマットを使用します。詳細は <a href="https://docs.oracle.com/javase/8/docs/api/java/time/Duration.html#parse-java.lang.CharSequence-">Duration#parse() javadoc</a> を参照してください。</p>
</div>
<div class="paragraph">
<p>数値で始まる期間の値を指定することもできます。この場合、値が数値のみで構成されている場合、コンバーターは値を秒として扱います。そうでない場合は、 <code>PT</code> が暗黙的に値の前に付加され、標準の <code>java.time.Duration</code> 形式が得られます。</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>キャッシュの設定は以下のようになります。</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.cache.caffeine."foo".initial-capacity=10 <i class="conum" data-value="1"></i><b>(1)</b>
quarkus.cache.caffeine."foo".maximum-size=20
quarkus.cache.caffeine."foo".expire-after-write=60S
quarkus.cache.caffeine."bar".maximum-size=1000 <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>foo</code> キャッシュの設定を行っています。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>bar</code> キャッシュの設定を行っています。</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="enabling-micrometer-metrics"><a class="anchor" href="#enabling-micrometer-metrics"></a>Enabling Micrometer metrics</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Each cache declared using the <a href="#annotations-api">annotations caching API</a> can be monitored using Micrometer metrics.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The cache metrics collection will only work if your application depends on a <code>quarkus-micrometer-registry-*</code> extension. See the <a href="micrometer">Micrometer metrics guide</a> to learn how to use Micrometer in Quarkus.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The cache metrics collection is disabled by default. It can be enabled from the <code>application.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">quarkus.cache.caffeine."foo".metrics-enabled=true</code></pre>
</div>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<div class="paragraph">
<p>Like all instrumentation methods, collecting metrics comes with a small overhead that can impact the application performances.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The collected metrics contain cache statistics such as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the approximate current number of entries in the cache</p>
</li>
<li>
<p>the number of entries that were added to the cache</p>
</li>
<li>
<p>the number of times a cache lookup has been performed, including information about hits and misses</p>
</li>
<li>
<p>the number of evictions and the weight of the evicted entries</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is an example of cache metrics available for an application that depends on the <code>quarkus-micrometer-registry-prometheus</code> extension:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs"># HELP cache_size The number of entries in this cache. This may be an approximation, depending on the type of cache.
# TYPE cache_size gauge
cache_size{cache="foo",} 8.0
# HELP cache_puts_total The number of entries added to the cache
# TYPE cache_puts_total counter
cache_puts_total{cache="foo",} 12.0
# HELP cache_gets_total The number of times cache lookup methods have returned a cached value.
# TYPE cache_gets_total counter
cache_gets_total{cache="foo",result="hit",} 53.0
cache_gets_total{cache="foo",result="miss",} 12.0
# HELP cache_evictions_total cache evictions
# TYPE cache_evictions_total counter
cache_evictions_total{cache="foo",} 4.0
# HELP cache_eviction_weight_total The sum of weights of evicted entries. This total does not include manual invalidations.
# TYPE cache_eviction_weight_total counter
cache_eviction_weight_total{cache="foo",} 540.0</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="注釈付きbean例"><a class="anchor" href="#注釈付きbean例"></a>注釈付きBean例</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="暗黙の単純キャッシュキー"><a class="anchor" href="#暗黙の単純キャッシュキー"></a>暗黙の単純キャッシュキー</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.cache;

import javax.enterprise.context.ApplicationScoped;

import io.quarkus.cache.CacheInvalidate;
import io.quarkus.cache.CacheInvalidateAll;
import io.quarkus.cache.CacheResult;

@ApplicationScoped
public class CachedService {

    @CacheResult(cacheName = "foo")
    public Object load(Object key) { <i class="conum" data-value="1"></i><b>(1)</b>
        // Call expensive service here.
    }

    @CacheInvalidate(cacheName = "foo")
    public void invalidate(Object key) { <i class="conum" data-value="1"></i><b>(1)</b>
    }

    @CacheInvalidateAll(cacheName = "foo")
    public void invalidateAll() {
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>@CacheKey</code> アノテーションがないので、キャッシュキーは暗黙の了解です。</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="明示的な合成キャッシュキー"><a class="anchor" href="#明示的な合成キャッシュキー"></a>明示的な合成キャッシュキー</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.cache;

import javax.enterprise.context.Dependent;

import io.quarkus.cache.CacheInvalidate;
import io.quarkus.cache.CacheInvalidateAll;
import io.quarkus.cache.CacheKey;
import io.quarkus.cache.CacheResult;

@Dependent
public class CachedService {

    @CacheResult(cacheName = "foo")
    public String load(@CacheKey Object keyElement1, @CacheKey Object keyElement2, Object notPartOfTheKey) { <i class="conum" data-value="1"></i><b>(1)</b>
        // Call expensive service here.
    }

    @CacheInvalidate(cacheName = "foo")
    public void invalidate(@CacheKey Object keyElement1, @CacheKey Object keyElement2, Object notPartOfTheKey) { <i class="conum" data-value="1"></i><b>(1)</b>
    }

    @CacheInvalidateAll(cacheName = "foo")
    public void invalidateAll() {
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>キャッシュキーは明示的に 2 つの要素で構成されています。メソッドシグネチャには、キーの一部ではない第三引数も含まれています。</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="デフォルトのキャッシュキー"><a class="anchor" href="#デフォルトのキャッシュキー"></a>デフォルトのキャッシュキー</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.cache;

import javax.enterprise.context.Dependent;

import io.quarkus.cache.CacheInvalidate;
import io.quarkus.cache.CacheInvalidateAll;
import io.quarkus.cache.CacheResult;

@Dependent
public class CachedService {

    @CacheResult(cacheName = "foo")
    public String load() { <i class="conum" data-value="1"></i><b>(1)</b>
        // Call expensive service here.
    }

    @CacheInvalidate(cacheName = "foo")
    public void invalidate() { <i class="conum" data-value="1"></i><b>(1)</b>
    }

    @CacheInvalidateAll(cacheName = "foo")
    public void invalidateAll() {
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>メソッドには引数がないため、キャッシュ名から派生した一意のデフォルトキャッシュキーが使用されます。</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="単一のメソッドに複数のアノテーションを付与"><a class="anchor" href="#単一のメソッドに複数のアノテーションを付与"></a>単一のメソッドに複数のアノテーションを付与</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.cache;

import javax.inject.Singleton;

import io.quarkus.cache.CacheInvalidate;
import io.quarkus.cache.CacheInvalidateAll;
import io.quarkus.cache.CacheResult;

@Singleton
public class CachedService {

    @CacheInvalidate(cacheName = "foo")
    @CacheResult(cacheName = "foo")
    public String forceCacheEntryRefresh(Object key) { <i class="conum" data-value="1"></i><b>(1)</b>
        // Call expensive service here.
    }

    @CacheInvalidateAll(cacheName = "foo")
    @CacheInvalidateAll(cacheName = "bar")
    public void multipleInvalidateAll(Object key) { <i class="conum" data-value="2"></i><b>(2)</b>
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>このメソッドを使用して、指定されたキーに対応するキャッシュエントリーを強制的に更新することができます。</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>このメソッドは、一度の呼び出しで <code>foo</code> および <code>bar</code> キャッシュからのすべてのエントリーを無効にします。</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="clear-all-application-caches"><a class="anchor" href="#clear-all-application-caches"></a>Clear all application caches</h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">package org.acme.cache;

import javax.enterprise.context.ApplicationScoped;
import javax.inject.Inject;

import io.quarkus.cache.CacheManager;

@ApplicationScoped
public class CacheClearer {

    @Inject
    CacheManager cacheManager;

    public void clearAllCaches() {
        for (String cacheName : cacheManager.getCacheNames()) {
            cacheManager.getCache(cacheName).get().invalidateAll().await().indefinitely();
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="negative-cache"><a class="anchor" href="#negative-cache"></a>ネガティブキャッシングとnull</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(高価な)リモートコールの結果をキャッシュしたい場合があります。リモートコールが失敗した場合、結果や例外をキャッシュするのではなく、 次の呼び出しでリモートコールを再試行したい場合があります。</p>
</div>
<div class="paragraph">
<p>シンプルなアプローチとしては、例外をキャッチして <code>null</code> を返すことで、呼び出し元がそれに応じて行動できるようにすることができます。</p>
</div>
<div class="listingblock">
<div class="title">サンプルコード</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">    public void caller(int val) {

        Integer result = callRemote(val); <i class="conum" data-value="1"></i><b>(1)</b>
        if (result != null) {
            System.out.println("Result is " + result);
        else {
            System.out.println("Got an exception");
        }
    }

    @CacheResult(cacheName = "foo")
    public Integer callRemote(int val)  {

        try {
            Integer val = remoteWebServer.getResult(val); <i class="conum" data-value="2"></i><b>(2)</b>
            return val;
        } catch (Exception e) {
            return null; <i class="conum" data-value="3"></i><b>(3)</b>
        }
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>リモートを呼び出すためにメソッドを実行</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>リモートコールを行い、その結果を返却</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>例外が発生時にリターンする</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>このアプローチには不幸な副作用があります。先に述べたように、Quarkusは <code>null</code> の値をキャッシュすることもできます。つまり、同じパラメーター値を持つ <code>callRemote()</code> への次の呼び出しは、キャッシュの外で応答され、 <code>null</code> が返され、リモートコールは行われないということです。これはシナリオによっては望ましいことかもしれませんが、通常は結果が返ってくるまでリモートコールを再試行したいものです。</p>
</div>
<div class="sect2">
<h3 id="例外をバブルアップさせる"><a class="anchor" href="#例外をバブルアップさせる"></a>例外をバブルアップさせる</h3>
<div class="paragraph">
<p>リモートコールの結果をキャッシュ(マーカー)しないようにするには、コールされたメソッドから例外をバブルアップし、呼び出し側でキャッチする必要があります。</p>
</div>
<div class="listingblock">
<div class="title">例外をバブルアップ</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">   public void caller(int val) {
       try {
           Integer result = callRemote(val);  <i class="conum" data-value="1"></i><b>(1)</b>
           System.out.println("Result is " + result);
       } catch (Exception e) {
           System.out.println("Got an exception");
   }

   @CacheResult(cacheName = "foo")
   public Integer callRemote(int val) throws Exception { <i class="conum" data-value="2"></i><b>(2)</b>

      Integer val = remoteWebServer.getResult(val);  <i class="conum" data-value="3"></i><b>(3)</b>
      return val;

   }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>リモートを呼び出すためにメソッドを実行</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>例外がバブルアップする場合がある</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>これは、あらゆる種類のリモート例外を投げることができます</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>リモートへの呼び出しが例外をスローした場合、キャッシュは結果を保存しないので、 同じパラメーター値を持つ <code>callRemote()</code> への後続の呼び出しがキャッシュから応答されることはありません。その代わりに、リモートへの呼び出しを再度試みることになります。</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ネイティブ化"><a class="anchor" href="#ネイティブ化"></a>ネイティブ化</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The Cache extension supports building native executables.</p>
</div>
<div class="paragraph">
<p>However, to optimize runtime speed, Caffeine embarks many cache implementation classes that are selected depending on the cache configuration. We are not registering all of them for reflection (and the ones not registered are not included into the native executables) as registering all of them would be very costly.</p>
</div>
<div class="paragraph">
<p>We are registering the most common implementations but, depending on your cache configuration, you might encounter errors like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-none hljs">2021-12-08 02:32:02,108 ERROR [io.qua.run.Application] (main) Failed to start application (with profile prod): java.lang.ClassNotFoundException: com.github.benmanes.caffeine.cache.PSAMS <i class="conum" data-value="1"></i><b>(1)</b>
        at java.lang.Class.forName(DynamicHub.java:1433)
        at java.lang.Class.forName(DynamicHub.java:1408)
        at com.github.benmanes.caffeine.cache.NodeFactory.newFactory(NodeFactory.java:111)
        at com.github.benmanes.caffeine.cache.BoundedLocalCache.&lt;init&gt;(BoundedLocalCache.java:240)
        at com.github.benmanes.caffeine.cache.SS.&lt;init&gt;(SS.java:31)
        at com.github.benmanes.caffeine.cache.SSMS.&lt;init&gt;(SSMS.java:64)
        at com.github.benmanes.caffeine.cache.SSMSA.&lt;init&gt;(SSMSA.java:43)</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>PSAMS</code> is one of the many cache implementation classes of Caffeine so this part may vary.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When you encounter this error, you can easily fix it by adding the following annotation to any of your application classes (or you can create a new class such as <code>Reflections</code> just to host this annotation if you prefer):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">@RegisterForReflection(classNames = { "com.github.benmanes.caffeine.cache.PSAMS" }) <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>It is an array so you can register several cache implementations in one go if your configuration requires several of them.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This annotation will register the cache implementation classes for reflection and this will include the classes into the native executable.</p>
</div>
</div>
</div>
    </div>
  </div>
</div>

  </div>

  <div class="content project-footer">
  <div class="footer-section">
    <div class="logo-wrapper">
      <a href="/"><img src="/assets/images/quarkus_logo_horizontal_rgb_reverse.svg" class="project-logo" title="Quarkus"></a>
    </div>
  </div>
  <div class="grid-wrapper">
    <p class="grid__item width-3-12">Quarkus はオープンです。このプロジェクトの全ての依存関係は<a href='https://www.apache.org/licenses/LICENSE-2.0' target='_blank'>Apache Software License 2.0</a>または互換性のあるライセンスの元で利用出来ます。<br /><br />このウェブサイトは <a href='https://jekyllrb.com/' target='_blank'>Jekyll</a> で構築されており、<a href='https://pages.github.com/' target='_blank'>Github Pages</a>にホストされており、完全にオープンソースです。改善したい場合、 <a href='https://github.com/quarkusio/quarkusio.github.io' target='_blank'>ウェブサイトをフォークし</a>、修正してみせてください。</p>

    
      <div class="width-1-12 project-links">
        <span>ナビゲーション</span>
        <ul class="footer-links">
          
            <li><a href="/">ホーム</a></li>
          
            <li><a href="/about">Quarkusについて</a></li>
          
            <li><a href="/blog">ブログ</a></li>
          
            <li><a href="/insights">ポッドキャスト</a></li>
          
            <li><a href="/events">イベント</a></li>
          
            <li><a href="/newsletter">ニュースレター</a></li>
          
            <li><a href="/publications">出版</a></li>
          
            <li><a href="/awards">受賞</a></li>
          
            <li><a href="/security">セキュリティポリシー</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>フォロー</span>
        <ul class="footer-links">
          
            <li><a href="https://twitter.com/quarkusio">Twitter</a></li>
          
            <li><a href="https://www.facebook.com/quarkusio">Facebook</a></li>
          
            <li><a href="https://www.linkedin.com/company/quarkusio/">Linkedin</a></li>
          
            <li><a href="https://www.youtube.com/channel/UCaW8QG_QoIk_FnjLgr5eOqg">Youtube</a></li>
          
            <li><a href="https://github.com/quarkusio">GitHub</a></li>
          
        </ul>
      </div>
    
      <div class="width-2-12 project-links">
        <span>ヘルプ</span>
        <ul class="footer-links">
          
            <li><a href="/support">サポート</a></li>
          
            <li><a href="/guides">ガイド</a></li>
          
            <li><a href="/faq">FAQ</a></li>
          
            <li><a href="/get-started">入門</a></li>
          
            <li><a href="https://stackoverflow.com/questions/tagged/quarkus">Stack Overflow</a></li>
          
            <li><a href="https://github.com/quarkusio/quarkus/discussions">ディスカッション</a></li>
          
            <li><a href="https://groups.google.com/forum/#!forum/quarkus-dev">開発メーリングリスト</a></li>
          
        </ul>
      </div>
    
      <div class="width-1-12 project-links">
        <span>Languages</span>
        <ul class="footer-links">
          
            <li><a href="https://quarkus.io/">English</a></li>
          
            <li><a href="https://ja.quarkus.io/">Japanese</a></li>
          
        </ul>
      </div>
    

    
      <div class="width-4-12 more-links">
        <span>Quarkusはコミュニティプロジェクトで構成されています：</span>
        <ul class="footer-links">
          
            <li><a href="https://vertx.io/" target="_blank">Eclipse Vert.x</a></li>
          
            <li><a href="https://smallrye.io" target="_blank">SmallRye</a></li>
          
            <li><a href="https://hibernate.org" target="_blank">Hibernate</a></li>
          
            <li><a href="https://netty.io" target="_blank">Netty</a></li>
          
            <li><a href="https://resteasy.github.io" target="_blank">RESTEasy</a></li>
          
            <li><a href="https://camel.apache.org" target="_blank">Apache Camel</a></li>
          
            <li><a href="https://microprofile.io" target="_blank">Eclipse MicroProfile</a></li>
          
            <li><a href="https://code.quarkus.io/" target="_blank">等々...</a></li>
          
        </ul>
      </div>
    
  </div>
</div>

  <div class="content redhat-footer">
  <div class="grid-wrapper">
    <span class="licence">
      <i class="fab fa-creative-commons"></i><i class="fab fa-creative-commons-by"></i> <a href="https://creativecommons.org/licenses/by/3.0/" target="_blank">CC by 3.0</a> | <a href="https://www.redhat.com/en/about/privacy-policy">Privacy Policy</a>
    </span>
    <span class="redhat">
      Sponsored by
    </span>
    <span class="redhat-logo">
      <a href="https://www.redhat.com/" target="_blank"><img src="/assets/images/redhat_reversed.svg"></a>
    </span>
  </div>
</div>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js" integrity="sha384-8gBf6Y4YYq7Jx97PIqmTwLPin4hxIzQw5aDmUg/DDhul9fFpbbLcLh3nTIIDJKhx" crossorigin="anonymous"></script>
  <script type="text/javascript" src="/assets/javascript/mobile-nav.js"></script>
  <script type="text/javascript" src="/assets/javascript/scroll-down.js"></script>
  <script src="/assets/javascript/satellite.js" type="text/javascript"></script>
  <script src="/guides/javascript/config.js" type="text/javascript"></script>
  <script src="/assets/javascript/search-filter.js" type="text/javascript"></script>
  <script src="/assets/javascript/guides-version-dropdown.js" type="text/javascript"></script>
  <script src="/assets/javascript/back-to-top.js" type="text/javascript"></script>
  <script src="/assets/javascript/clipboard.min.js" type="text/javascript"></script>
  <script src="/assets/javascript/copy.js" type="text/javascript"></script>
  <script src="/assets/javascript/asciidoc-tabs.js" type="text/javascript"></script>
</body>

</html>
